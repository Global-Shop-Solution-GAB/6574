Program.Sub.ScreenSU.Start
Gui.FormTimesheet..create(BaseForm)
Gui.FormTimesheet..caption("Timesheet Entry")
Gui.FormTimesheet..size(20685,10455)
Gui.FormTimesheet..minx(17000)
Gui.FormTimesheet..miny(9000)
Gui.FormTimesheet..position(0,0)
Gui.FormTimesheet..event(UnLoad,FormTimesheet_unload)
Gui.FormTimesheet..forecolor(0)
Gui.FormTimesheet..BackColor(-2147483633)
Gui.FormTimesheet..mousepointer(0)
Gui.FormTimesheet..AlwaysOnTop(False)
Gui.FormTimesheet..FontName("Tahoma")
Gui.FormTimesheet..FontSize(8.25)
Gui.FormTimesheet..ControlBox(True)
Gui.FormTimesheet..MaxButton(True)
Gui.FormTimesheet..MinButton(True)
Gui.FormTimesheet..Moveable(True)
Gui.FormTimesheet..Sizeable(True)
Gui.FormTimesheet..ShowInTaskBar(True)
Gui.FormTimesheet..TitleBar(True)
Gui.FormTimesheet.dtpWeek.create(datepicker)
Gui.FormTimesheet.dtpWeek.size(1935,285)
Gui.FormTimesheet.dtpWeek.position(120,315)
Gui.FormTimesheet.dtpWeek.event(Change,dtpweek_change)
Gui.FormTimesheet.dtpWeek.tabstop(True)
Gui.FormTimesheet.dtpWeek.tabindex(1)
Gui.FormTimesheet.dtpWeek.Enabled(True)
Gui.FormTimesheet.dtpWeek.Visible(True)
Gui.FormTimesheet.dtpWeek.Zorder(0)
Gui.FormTimesheet.dtpWeek.CheckBox(False)
Gui.FormTimesheet.dtpWeek.FontName("Tahoma")
Gui.FormTimesheet.dtpWeek.FontSize(8.25)
Gui.FormTimesheet.gsgcTimesheet.create(GsGridControl)
Gui.FormTimesheet.gsgcTimesheet.size(19500,8985)
Gui.FormTimesheet.gsgcTimesheet.position(0,705)
Gui.FormTimesheet.gsgcTimesheet.Event(RowCellClick,gsgcTimesheet_RowCellClick)
Gui.FormTimesheet.gsgcTimesheet.Event(CellValueChanged,gsgcTimesheet_CellValueChanged)
Gui.FormTimesheet.gsgcTimesheet.Anchor(15)
Gui.FormTimesheet.gsgcTimesheet.Enabled(True)
Gui.FormTimesheet.gsgcTimesheet.Visible(True)
Gui.FormTimesheet.gsgcTimesheet.Zorder(0)
Gui.FormTimesheet.cmdUpdate.create(button)
Gui.FormTimesheet.cmdUpdate.caption("Lock/Post to GSS")
Gui.FormTimesheet.cmdUpdate.size(1860,375)
Gui.FormTimesheet.cmdUpdate.position(1095,9720)
Gui.FormTimesheet.cmdUpdate.event(Click,cmdupdate_click)
Gui.FormTimesheet.cmdUpdate.disableonclick(20)
Gui.FormTimesheet.cmdUpdate.defaultvalue("")
Gui.FormTimesheet.cmdUpdate.tabstop(True)
Gui.FormTimesheet.cmdUpdate.tabindex(12)
Gui.FormTimesheet.cmdUpdate.Anchor(6)
Gui.FormTimesheet.cmdUpdate.Enabled(True)
Gui.FormTimesheet.cmdUpdate.Visible(True)
Gui.FormTimesheet.cmdUpdate.Zorder(0)
Gui.FormTimesheet.cmdUpdate.FontName("Tahoma")
Gui.FormTimesheet.cmdUpdate.FontSize(8.25)
Gui.FormTimesheet.cmdTemp.create(button)
Gui.FormTimesheet.cmdTemp.caption("Template")
Gui.FormTimesheet.cmdTemp.size(960,375)
Gui.FormTimesheet.cmdTemp.position(2085,9720)
Gui.FormTimesheet.cmdTemp.event(Click,cmdtemp_click)
Gui.FormTimesheet.cmdTemp.defaultvalue("")
Gui.FormTimesheet.cmdTemp.tabstop(True)
Gui.FormTimesheet.cmdTemp.tabindex(13)
Gui.FormTimesheet.cmdTemp.Anchor(6)
Gui.FormTimesheet.cmdTemp.Enabled(True)
Gui.FormTimesheet.cmdTemp.Visible(True)
Gui.FormTimesheet.cmdTemp.Zorder(0)
Gui.FormTimesheet.cmdTemp.FontName("Tahoma")
Gui.FormTimesheet.cmdTemp.FontSize(8.25)
Gui.FormTimesheet.cmdSave.create(button)
Gui.FormTimesheet.cmdSave.caption("Save")
Gui.FormTimesheet.cmdSave.size(855,375)
Gui.FormTimesheet.cmdSave.position(105,9720)
Gui.FormTimesheet.cmdSave.event(Click,cmdsave_click)
Gui.FormTimesheet.cmdSave.defaultvalue("")
Gui.FormTimesheet.cmdSave.tabstop(True)
Gui.FormTimesheet.cmdSave.tabindex(11)
Gui.FormTimesheet.cmdSave.Anchor(6)
Gui.FormTimesheet.cmdSave.Enabled(True)
Gui.FormTimesheet.cmdSave.Visible(True)
Gui.FormTimesheet.cmdSave.Zorder(0)
Gui.FormTimesheet.cmdSave.FontName("Tahoma")
Gui.FormTimesheet.cmdSave.FontSize(8.25)
Gui.FormTimesheet.lblDate.create(label,"Select Week",True,1935,255,1,120,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblDate.defaultvalue("")
Gui.FormTimesheet.lblDate.BorderStyle(0)
Gui.FormTimesheet.cmdRefresh.create(button)
Gui.FormTimesheet.cmdRefresh.caption("Refresh")
Gui.FormTimesheet.cmdRefresh.size(855,375)
Gui.FormTimesheet.cmdRefresh.position(2115,255)
Gui.FormTimesheet.cmdRefresh.event(Click,cmdrefresh_click)
Gui.FormTimesheet.cmdRefresh.disableonclick(20)
Gui.FormTimesheet.cmdRefresh.defaultvalue("")
Gui.FormTimesheet.cmdRefresh.tabstop(True)
Gui.FormTimesheet.cmdRefresh.tabindex(2)
Gui.FormTimesheet.cmdRefresh.Enabled(True)
Gui.FormTimesheet.cmdRefresh.Visible(True)
Gui.FormTimesheet.cmdRefresh.Zorder(0)
Gui.FormTimesheet.cmdRefresh.FontName("Tahoma")
Gui.FormTimesheet.cmdRefresh.FontSize(8.25)
Gui.FormTimesheet.txtAJob.create(textbox,"",True,1050,300,0,3480,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtAJob.defaultvalue("")
Gui.FormTimesheet.txtAJob.MaxLength(6)
Gui.FormTimesheet.txtAJob.TabStop(True)
Gui.FormTimesheet.txtAJob.TabIndex(3)
Gui.FormTimesheet.txtASuff.create(textbox,"",True,570,300,0,4635,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtASuff.defaultvalue("")
Gui.FormTimesheet.txtASuff.MaxLength(3)
Gui.FormTimesheet.txtASuff.TabStop(True)
Gui.FormTimesheet.txtASuff.TabIndex(4)
Gui.FormTimesheet.cmdAddJobBrows.create(button)
Gui.FormTimesheet.cmdAddJobBrows.caption("^")
Gui.FormTimesheet.cmdAddJobBrows.size(345,375)
Gui.FormTimesheet.cmdAddJobBrows.position(5310,255)
Gui.FormTimesheet.cmdAddJobBrows.event(Click,cmdaddjobbrows_click)
Gui.FormTimesheet.cmdAddJobBrows.defaultvalue("")
Gui.FormTimesheet.cmdAddJobBrows.Enabled(True)
Gui.FormTimesheet.cmdAddJobBrows.Visible(True)
Gui.FormTimesheet.cmdAddJobBrows.Zorder(0)
Gui.FormTimesheet.cmdAddJobBrows.FontName("Tahoma")
Gui.FormTimesheet.cmdAddJobBrows.FontSize(8.25)
Gui.FormTimesheet.txtASeq.create(textbox,"",True,765,300,0,5865,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtASeq.defaultvalue("")
Gui.FormTimesheet.txtASeq.MaxLength(6)
Gui.FormTimesheet.txtASeq.TabStop(True)
Gui.FormTimesheet.txtASeq.TabIndex(5)
Gui.FormTimesheet.cmdAddSeqBrows.create(button)
Gui.FormTimesheet.cmdAddSeqBrows.caption("^")
Gui.FormTimesheet.cmdAddSeqBrows.size(345,375)
Gui.FormTimesheet.cmdAddSeqBrows.position(6750,270)
Gui.FormTimesheet.cmdAddSeqBrows.event(Click,cmdaddseqbrows_click)
Gui.FormTimesheet.cmdAddSeqBrows.defaultvalue("")
Gui.FormTimesheet.cmdAddSeqBrows.Enabled(True)
Gui.FormTimesheet.cmdAddSeqBrows.Visible(True)
Gui.FormTimesheet.cmdAddSeqBrows.Zorder(0)
Gui.FormTimesheet.cmdAddSeqBrows.FontName("Tahoma")
Gui.FormTimesheet.cmdAddSeqBrows.FontSize(8.25)
Gui.FormTimesheet.lblASeq.create(label,"Sequence",True,870,255,1,5865,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblASeq.defaultvalue("")
Gui.FormTimesheet.lblASeq.BorderStyle(0)
Gui.FormTimesheet.lblASuff.create(label,"Suffix",True,600,255,1,4635,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblASuff.defaultvalue("")
Gui.FormTimesheet.lblASuff.BorderStyle(0)
Gui.FormTimesheet.lblAJob.create(label,"Job",True,735,255,1,3480,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblAJob.defaultvalue("")
Gui.FormTimesheet.lblAJob.BorderStyle(0)
Gui.FormTimesheet.cmdAdd.create(button)
Gui.FormTimesheet.cmdAdd.caption("Add")
Gui.FormTimesheet.cmdAdd.size(1110,375)
Gui.FormTimesheet.cmdAdd.position(9870,255)
Gui.FormTimesheet.cmdAdd.event(Click,cmdadd_click)
Gui.FormTimesheet.cmdAdd.disableonclick(20)
Gui.FormTimesheet.cmdAdd.defaultvalue("")
Gui.FormTimesheet.cmdAdd.tabstop(True)
Gui.FormTimesheet.cmdAdd.tabindex(7)
Gui.FormTimesheet.cmdAdd.Enabled(True)
Gui.FormTimesheet.cmdAdd.Visible(True)
Gui.FormTimesheet.cmdAdd.Zorder(0)
Gui.FormTimesheet.cmdAdd.FontName("Tahoma")
Gui.FormTimesheet.cmdAdd.FontSize(8.25)
Gui.FormTimesheet.cmdReady.create(button)
Gui.FormTimesheet.cmdReady.caption("Ready for Approval")
Gui.FormTimesheet.cmdReady.size(1710,375)
Gui.FormTimesheet.cmdReady.position(3120,9720)
Gui.FormTimesheet.cmdReady.event(Click,cmdready_click)
Gui.FormTimesheet.cmdReady.defaultvalue("")
Gui.FormTimesheet.cmdReady.TabStop(True)
Gui.FormTimesheet.cmdReady.TabIndex(14)
Gui.FormTimesheet.cmdReady.Anchor(6)
Gui.FormTimesheet.cmdReady.Enabled(True)
Gui.FormTimesheet.cmdReady.Visible(True)
Gui.FormTimesheet.cmdReady.Zorder(0)
Gui.FormTimesheet.cmdReady.FontName("Tahoma")
Gui.FormTimesheet.cmdReady.FontSize(8.25)
Gui.FormTimesheet.cmdPrint.create(button)
Gui.FormTimesheet.cmdPrint.caption("Print")
Gui.FormTimesheet.cmdPrint.size(885,375)
Gui.FormTimesheet.cmdPrint.position(4050,9720)
Gui.FormTimesheet.cmdPrint.event(Click,cmdprint_click)
Gui.FormTimesheet.cmdPrint.defaultvalue("")
Gui.FormTimesheet.cmdPrint.Anchor(6)
Gui.FormTimesheet.cmdPrint.Enabled(True)
Gui.FormTimesheet.cmdPrint.Visible(True)
Gui.FormTimesheet.cmdPrint.Zorder(0)
Gui.FormTimesheet.cmdPrint.FontName("Tahoma")
Gui.FormTimesheet.cmdPrint.FontSize(8.25)
Gui.FormTimesheet.txtEmployee.create(textbox,"",True,1020,300,0,11220,9780,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtEmployee.maxLength(5)
Gui.FormTimesheet.txtEmployee.defaultvalue("")
Gui.FormTimesheet.txtEmployee.Event(LostFocus,txtEmployee_Change)
Gui.FormTimesheet.txtEmployee.TabStop(True)
Gui.FormTimesheet.txtEmployee.TabIndex(8)
Gui.FormTimesheet.txtEmployee.Anchor(6)
Gui.FormTimesheet.lblEmp.create(label,"Employee",True,810,255,1,10365,9870,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblEmp.defaultvalue("")
Gui.FormTimesheet.lblEmp.Anchor(6)
Gui.FormTimesheet.lblEmp.BorderStyle(0)
Gui.FormTimesheet.cmdEmpBrws.create(button)
Gui.FormTimesheet.cmdEmpBrws.caption("^")
Gui.FormTimesheet.cmdEmpBrws.size(465,375)
Gui.FormTimesheet.cmdEmpBrws.position(12285,9750)
Gui.FormTimesheet.cmdEmpBrws.event(Click,cmdempbrws_click)
Gui.FormTimesheet.cmdEmpBrws.defaultvalue("")
Gui.FormTimesheet.cmdEmpBrws.Anchor(6)
Gui.FormTimesheet.cmdEmpBrws.Enabled(False)
Gui.FormTimesheet.cmdEmpBrws.Visible(False)
Gui.FormTimesheet.cmdEmpBrws.Zorder(0)
Gui.FormTimesheet.cmdEmpBrws.FontName("Tahoma")
Gui.FormTimesheet.cmdEmpBrws.FontSize(8.25)
Gui.FormTimesheet.cmdEmpSearch.create(button)
Gui.FormTimesheet.cmdEmpSearch.caption("Refresh")
Gui.FormTimesheet.cmdEmpSearch.size(1095,420)
Gui.FormTimesheet.cmdEmpSearch.position(14415,9720)
Gui.FormTimesheet.cmdEmpSearch.event(Click,cmdempsearch_click)
Gui.FormTimesheet.cmdEmpSearch.defaultvalue("")
Gui.FormTimesheet.cmdEmpSearch.TabStop(True)
Gui.FormTimesheet.cmdEmpSearch.TabIndex(9)
Gui.FormTimesheet.cmdEmpSearch.Anchor(6)
Gui.FormTimesheet.cmdEmpSearch.Enabled(False)
Gui.FormTimesheet.cmdEmpSearch.Visible(False)
Gui.FormTimesheet.cmdEmpSearch.Zorder(0)
Gui.FormTimesheet.cmdEmpSearch.FontName("Tahoma")
Gui.FormTimesheet.cmdEmpSearch.FontSize(8.25)
Gui.FormTimesheet.cmdUnlock.create(button)
Gui.FormTimesheet.cmdUnlock.caption("Unlock")
Gui.FormTimesheet.cmdUnlock.visible(False)
Gui.FormTimesheet.cmdUnlock.size(855,375)
Gui.FormTimesheet.cmdUnlock.position(4095,9720)
Gui.FormTimesheet.cmdUnlock.event(Click,cmdunlock_click)
Gui.FormTimesheet.cmdUnlock.defaultvalue("")
Gui.FormTimesheet.cmdUnlock.TabStop(True)
Gui.FormTimesheet.cmdUnlock.TabIndex(15)
Gui.FormTimesheet.cmdUnlock.Anchor(6)
Gui.FormTimesheet.cmdUnlock.Enabled(True)
Gui.FormTimesheet.cmdUnlock.Zorder(0)
Gui.FormTimesheet.cmdUnlock.FontName("Tahoma")
Gui.FormTimesheet.cmdUnlock.FontSize(8.25)
Gui.FormTimesheet.chkAllEmployees.create(checkbox)
Gui.FormTimesheet.chkAllEmployees.caption("Update All Employees")
Gui.FormTimesheet.chkAllEmployees.visible(False)
Gui.FormTimesheet.chkAllEmployees.size(2115,300)
Gui.FormTimesheet.chkAllEmployees.position(5235,9780)
Gui.FormTimesheet.chkAllEmployees.tooltip("Upload all employee times that are marked as Ready.")
Gui.FormTimesheet.chkAllEmployees.TabStop(True)
Gui.FormTimesheet.chkAllEmployees.TabIndex(16)
Gui.FormTimesheet.chkAllEmployees.Anchor(6)
Gui.FormTimesheet.chkAllEmployees.Enabled(True)
Gui.FormTimesheet.chkAllEmployees.Zorder(0)
Gui.FormTimesheet.chkAllEmployees.FontName("Tahoma")
Gui.FormTimesheet.chkAllEmployees.FontSize(8.25)
Gui.FormTimesheet.txtUser.create(textbox,"",True,1020,300,1,13350,9780,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtUser.maxLength(10)
Gui.FormTimesheet.txtUser.defaultvalue("")
Gui.FormTimesheet.txtUser.TabStop(True)
Gui.FormTimesheet.txtUser.TabIndex(10)
Gui.FormTimesheet.txtUser.Anchor(6)
Gui.FormTimesheet.txtUser.Event(LostFocus,txtUser_LostFocus)
Gui.FormTimesheet.lblUser.create(label,"User",True,540,255,0,12810,9870,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblUser.defaultvalue("")
Gui.FormTimesheet.lblUser.Anchor(6)
Gui.FormTimesheet.lblUser.BorderStyle(0)
Gui.FormTimesheet.lblASeq2.Create(Label,"Work Center",True,1170,255,1,7290,120,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblASeq2.DefaultValue("")
Gui.FormTimesheet.lblASeq2.BorderStyle(0)
Gui.FormTimesheet.txtWC.Create(TextBox,"",True,765,300,0,7320,300,True,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtWC.DefaultValue("")
Gui.FormTimesheet.txtWC.MaxLength(4)
Gui.FormTimesheet.txtWC.TabStop(True)
Gui.FormTimesheet.txtWC.TabIndex(6)
Gui.FormTimesheet.cmdAddWC.Create(Button)
Gui.FormTimesheet.cmdAddWC.Size(345,375)
Gui.FormTimesheet.cmdAddWC.Position(8220,270)
Gui.FormTimesheet.cmdAddWC.Caption("^")
Gui.FormTimesheet.cmdAddWC.DefaultValue("")
Gui.FormTimesheet.cmdAddWC.Event(Click,cmdAddWC_Click)
Gui.FormTimesheet.cmdAddWC.Enabled(True)
Gui.FormTimesheet.cmdAddWC.Visible(True)
Gui.FormTimesheet.cmdAddWC.Zorder(0)
Gui.FormTimesheet.cmdAddWC.FontName("Tahoma")
Gui.FormTimesheet.cmdAddWC.FontSize(8.25)
Gui.FormTimesheet.lbl1.Create(Label,"Sun Hrs",True,1035,255,0,19545,1080,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl1.Anchor(9)
Gui.FormTimesheet.lbl1.BorderStyle(0)
Gui.FormTimesheet.txtSunHrs.Create(TextBox,"",True,870,300,0,19575,1305,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtSunHrs.NumericOnly(1)
Gui.FormTimesheet.txtSunHrs.Locked(True)
Gui.FormTimesheet.txtSunHrs.ForeColor(0)
Gui.FormTimesheet.txtSunHrs.Anchor(9)
Gui.FormTimesheet.lbl2.Create(Label,"Mon Hrs",True,1035,255,0,19575,1965,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl2.Anchor(9)
Gui.FormTimesheet.lbl2.BorderStyle(0)
Gui.FormTimesheet.lbl3.Create(Label,"Tues Hrs",True,1035,255,0,19575,2985,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl3.Anchor(9)
Gui.FormTimesheet.lbl3.BorderStyle(0)
Gui.FormTimesheet.lbl4.Create(Label,"Wed Hrs",True,1035,255,0,19575,3975,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl4.Anchor(9)
Gui.FormTimesheet.lbl4.BorderStyle(0)
Gui.FormTimesheet.lbl5.Create(Label,"Thur Hrs",True,1035,255,0,19575,4965,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl5.Anchor(9)
Gui.FormTimesheet.lbl5.BorderStyle(0)
Gui.FormTimesheet.lbl6.Create(Label,"Fri Hrs",True,1035,255,0,19575,5970,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl6.Anchor(9)
Gui.FormTimesheet.lbl6.BorderStyle(0)
Gui.FormTimesheet.lbl7.Create(Label,"Sat Hrs",True,1035,255,0,19575,6945,True,0,"Arial",10,-2147483633,0,0)
Gui.FormTimesheet.lbl7.Anchor(9)
Gui.FormTimesheet.lbl7.BorderStyle(0)
Gui.FormTimesheet.lbl8.Create(Label,"Bucket Hrs.",True,840,210,0,14325,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl8.BorderStyle(0)
Gui.FormTimesheet.txtFriHrs.Create(TextBox,"",True,870,300,0,19575,6210,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtFriHrs.ForeColor(0)
Gui.FormTimesheet.txtFriHrs.NumericOnly(1)
Gui.FormTimesheet.txtFriHrs.Locked(True)
Gui.FormTimesheet.txtFriHrs.Anchor(9)
Gui.FormTimesheet.txtThurHrs.Create(TextBox,"",True,870,300,0,19575,5205,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtThurHrs.ForeColor(0)
Gui.FormTimesheet.txtThurHrs.NumericOnly(1)
Gui.FormTimesheet.txtThurHrs.Locked(True)
Gui.FormTimesheet.txtThurHrs.Anchor(9)
Gui.FormTimesheet.txtWedHrs.Create(TextBox,"",True,870,300,0,19575,4200,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtWedHrs.ForeColor(0)
Gui.FormTimesheet.txtWedHrs.NumericOnly(1)
Gui.FormTimesheet.txtWedHrs.Locked(True)
Gui.FormTimesheet.txtWedHrs.Anchor(9)
Gui.FormTimesheet.txtTuesHrs.Create(TextBox,"",True,870,300,0,19575,3225,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtTuesHrs.ForeColor(0)
Gui.FormTimesheet.txtTuesHrs.NumericOnly(1)
Gui.FormTimesheet.txtTuesHrs.Locked(True)
Gui.FormTimesheet.txtTuesHrs.Anchor(9)
Gui.FormTimesheet.txtMonHrs.Create(TextBox,"",True,870,300,0,19575,2205,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtMonHrs.ForeColor(0)
Gui.FormTimesheet.txtMonHrs.NumericOnly(1)
Gui.FormTimesheet.txtMonHrs.Locked(True)
Gui.FormTimesheet.txtMonHrs.Anchor(9)
Gui.FormTimesheet.txtSatHrs.Create(TextBox,"",True,870,300,0,19575,7185,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtSatHrs.ForeColor(0)
Gui.FormTimesheet.txtSatHrs.NumericOnly(1)
Gui.FormTimesheet.txtSatHrs.Locked(True)
Gui.FormTimesheet.txtSatHrs.Anchor(9)
Gui.FormTimesheet.txtTotHrs.Create(TextBox,"",True,870,300,0,14325,300,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtTotHrs.ForeColor(0)
Gui.FormTimesheet.txtTotHrs.NumericOnly(1)
Gui.FormTimesheet.txtTotHrs.Locked(True)
Gui.FormTimesheet.cmdFrmTemp.Create(Button)
Gui.FormTimesheet.cmdFrmTemp.Size(1770,375)
Gui.FormTimesheet.cmdFrmTemp.Position(11250,255)
Gui.FormTimesheet.cmdFrmTemp.TabStop(True)
Gui.FormTimesheet.cmdFrmTemp.TabIndex(7)
Gui.FormTimesheet.cmdFrmTemp.Caption("Add From Template")
Gui.FormTimesheet.cmdFrmTemp.DisableOnClick(20)
Gui.FormTimesheet.cmdFrmTemp.DefaultValue("")
Gui.FormTimesheet.cmdFrmTemp.Event(Click,cmdFrmTemp_Click)
Gui.FormTimesheet.cmdFrmTemp.Enabled(True)
Gui.FormTimesheet.cmdFrmTemp.Visible(True)
Gui.FormTimesheet.cmdFrmTemp.Zorder(0)
Gui.FormTimesheet.cmdFrmTemp.FontName("Tahoma")
Gui.FormTimesheet.cmdFrmTemp.FontSize(8.25)
Gui.FormTimesheet.lblDay.Create(Label,"Day",True,435,255,0,19845,75,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblDay.Anchor(9)
Gui.FormTimesheet.lblDay.BorderStyle(0)
Gui.FormTimesheet.txtBucketHrs.Create(TextBox,"Bucket Hrs.",True,1005,300,0,19545,255,False,0,"Arial",8,-2147483643,1)
Gui.FormTimesheet.txtBucketHrs.Anchor(9)
Gui.FormTimesheet.lblClockHrs.Create(Label,"Balance Hrs.",True,960,255,0,19590,615,False,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrs.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrs.Anchor(9)
Gui.FormTimesheet.lblClockHrs.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsMon.Create(Label,"Clock Hrs.",True,870,255,0,19575,2595,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsMon.Anchor(9)
Gui.FormTimesheet.lblClockHrsMon.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsMon.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsTues.Create(Label,"Clock Hrs.",True,870,255,0,19575,3585,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsTues.Anchor(9)
Gui.FormTimesheet.lblClockHrsTues.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsTues.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsWed.Create(Label,"Clock Hrs.",True,870,255,0,19575,4560,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsWed.Anchor(9)
Gui.FormTimesheet.lblClockHrsWed.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsWed.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsThur.Create(Label,"Clock Hrs.",True,870,255,0,19575,5565,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsThur.Anchor(9)
Gui.FormTimesheet.lblClockHrsThur.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsThur.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsFri.Create(Label,"Clock Hrs.",True,870,255,0,19575,6570,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsFri.Anchor(9)
Gui.FormTimesheet.lblClockHrsFri.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsFri.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsSat.Create(Label,"Clock Hrs.",True,870,255,0,19575,7545,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsSat.Anchor(9)
Gui.FormTimesheet.lblClockHrsSat.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsSat.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsSun.Create(Label,"Clock Hrs.",True,870,255,0,19545,1680,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsSun.Anchor(9)
Gui.FormTimesheet.lblClockHrsSun.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsSun.BorderStyle(0)
Gui.FormTimesheet.lblClockHrsTotal.Create(Label,"Clock Hrs.",False,870,255,0,19575,9660,False,2,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lblClockHrsTotal.Anchor(10)
Gui.FormTimesheet.lblClockHrsTotal.FontStyle(False,True,False,False,False)
Gui.FormTimesheet.lblClockHrsTotal.BorderStyle(0)
Gui.FormTimesheet.txtHoursTA.Create(TextBox,"",True,870,300,0,13380,300,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtHoursTA.ForeColor(0)
Gui.FormTimesheet.txtHoursTA.NumericOnly(1)
Gui.FormTimesheet.txtHoursTA.Locked(True)
Gui.FormTimesheet.txtHoursBalance.Create(TextBox,"",True,870,300,0,16215,300,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtHoursBalance.ForeColor(0)
Gui.FormTimesheet.txtHoursBalance.NumericOnly(1)
Gui.FormTimesheet.txtHoursBalance.Locked(True)
Gui.FormTimesheet.lbl9.Create(Label,"Hours TA",True,690,210,0,13380,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl9.BorderStyle(0)
Gui.FormTimesheet.lbl10.Create(Label,"Balance Hrs.",True,930,210,0,16215,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl10.BorderStyle(0)
Gui.FormTimesheet.txtGUIHours.Create(TextBox,"",True,870,300,0,15270,300,True,0,"Arial",8,-2147483626,1)
Gui.FormTimesheet.txtGUIHours.ForeColor(0)
Gui.FormTimesheet.txtGUIHours.NumericOnly(1)
Gui.FormTimesheet.txtGUIHours.Locked(True)
Gui.FormTimesheet.lbl11.Create(Label,"GUI Hrs.",True,600,210,0,15270,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormTimesheet.lbl11.BorderStyle(0)
Gui.FormTimesheet.cmdAddNotes.Create(Button)
Gui.FormTimesheet.cmdAddNotes.Enabled(True)
Gui.FormTimesheet.cmdAddNotes.Visible(True)
Gui.FormTimesheet.cmdAddNotes.Zorder(0)
Gui.FormTimesheet.cmdAddNotes.Size(1125,345)
Gui.FormTimesheet.cmdAddNotes.Position(8640,270)
Gui.FormTimesheet.cmdAddNotes.Caption("Add Notes")
Gui.FormTimesheet.cmdAddNotes.FontName("Tahoma")
Gui.FormTimesheet.cmdAddNotes.FontSize(8.25)
Gui.FormTimesheet.cmdAddNotes.Event(Click,cmdAddNotes_Click)
Gui.F_Template..create(BaseForm)
Gui.F_Template..caption("Template Entry")
Gui.F_Template..size(5640,7380)
Gui.F_Template..minx(0)
Gui.F_Template..miny(0)
Gui.F_Template..position(0,0)
Gui.F_Template..event(UnLoad,f_template_unload)
Gui.F_Template..forecolor(0)
Gui.F_Template..BackColor(-2147483633)
Gui.F_Template..maxbutton(False)
Gui.F_Template..mousepointer(0)
Gui.F_Template..sizeable(False)
Gui.F_Template..AlwaysOnTop(False)
Gui.F_Template..FontName("Tahoma")
Gui.F_Template..FontSize(8.25)
Gui.F_Template..ControlBox(True)
Gui.F_Template..MinButton(True)
Gui.F_Template..Moveable(True)
Gui.F_Template..ShowInTaskBar(True)
Gui.F_Template..TitleBar(True)
Gui.F_Template.lblJob.create(label,"Job",True,660,255,1,125,155,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblJob.defaultvalue("")
Gui.F_Template.lblJob.BorderStyle(0)
Gui.F_Template.txtTmpJob.create(textbox,"",True,1050,300,0,105,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpJob.defaultvalue("")
Gui.F_Template.txtTmpJob.TabStop(True)
Gui.F_Template.txtTmpJob.TabIndex(1)
Gui.F_Template.lblSuff.create(label,"Suffix",True,645,255,1,1275,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSuff.defaultvalue("")
Gui.F_Template.lblSuff.BorderStyle(0)
Gui.F_Template.txtTmpSuff.create(textbox,"",True,570,300,0,1275,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpSuff.defaultvalue("")
Gui.F_Template.txtTmpSuff.TabStop(True)
Gui.F_Template.txtTmpSuff.TabIndex(2)
Gui.F_Template.cmdTmpJobBrows.create(button)
Gui.F_Template.cmdTmpJobBrows.caption("^")
Gui.F_Template.cmdTmpJobBrows.size(345,375)
Gui.F_Template.cmdTmpJobBrows.position(1965,345)
Gui.F_Template.cmdTmpJobBrows.event(Click,cmdtmpjobbrows_click)
Gui.F_Template.cmdTmpJobBrows.defaultvalue("")
Gui.F_Template.cmdTmpJobBrows.TabStop(True)
Gui.F_Template.cmdTmpJobBrows.TabIndex(3)
Gui.F_Template.cmdTmpJobBrows.Enabled(True)
Gui.F_Template.cmdTmpJobBrows.Visible(True)
Gui.F_Template.cmdTmpJobBrows.Zorder(0)
Gui.F_Template.cmdTmpJobBrows.FontName("Tahoma")
Gui.F_Template.cmdTmpJobBrows.FontSize(8.25)
Gui.F_Template.lblSeq.create(label,"Sequence",True,1185,255,1,2580,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSeq.defaultvalue("")
Gui.F_Template.lblSeq.BorderStyle(0)
Gui.F_Template.txtTmpSeq.create(textbox,"",True,765,300,0,2580,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpSeq.defaultvalue("")
Gui.F_Template.txtTmpSeq.TabStop(True)
Gui.F_Template.txtTmpSeq.TabIndex(4)
Gui.F_Template.cmdTmpSeqBrows.create(button)
Gui.F_Template.cmdTmpSeqBrows.caption("^")
Gui.F_Template.cmdTmpSeqBrows.size(345,375)
Gui.F_Template.cmdTmpSeqBrows.position(3480,345)
Gui.F_Template.cmdTmpSeqBrows.event(Click,cmdtmpseqbrows_click)
Gui.F_Template.cmdTmpSeqBrows.defaultvalue("")
Gui.F_Template.cmdTmpSeqBrows.TabStop(True)
Gui.F_Template.cmdTmpSeqBrows.TabIndex(5)
Gui.F_Template.cmdTmpSeqBrows.Enabled(True)
Gui.F_Template.cmdTmpSeqBrows.Visible(True)
Gui.F_Template.cmdTmpSeqBrows.Zorder(0)
Gui.F_Template.cmdTmpSeqBrows.FontName("Tahoma")
Gui.F_Template.cmdTmpSeqBrows.FontSize(8.25)
Gui.F_Template.cmdTmpAdd.create(button)
Gui.F_Template.cmdTmpAdd.caption("Add")
Gui.F_Template.cmdTmpAdd.size(855,375)
Gui.F_Template.cmdTmpAdd.position(105,825)
Gui.F_Template.cmdTmpAdd.event(Click,cmdtmpadd_click)
Gui.F_Template.cmdTmpAdd.defaultvalue("")
Gui.F_Template.cmdTmpAdd.TabStop(True)
Gui.F_Template.cmdTmpAdd.TabIndex(8)
Gui.F_Template.cmdTmpAdd.Enabled(True)
Gui.F_Template.cmdTmpAdd.Visible(True)
Gui.F_Template.cmdTmpAdd.Zorder(0)
Gui.F_Template.cmdTmpAdd.FontName("Tahoma")
Gui.F_Template.cmdTmpAdd.FontSize(8.25)
Gui.F_Template.cmdTmpDelete.create(button)
Gui.F_Template.cmdTmpDelete.caption("Delete")
Gui.F_Template.cmdTmpDelete.size(855,375)
Gui.F_Template.cmdTmpDelete.position(1065,810)
Gui.F_Template.cmdTmpDelete.event(Click,cmdtmpdelete_click)
Gui.F_Template.cmdTmpDelete.defaultvalue("")
Gui.F_Template.cmdTmpDelete.TabStop(True)
Gui.F_Template.cmdTmpDelete.TabIndex(9)
Gui.F_Template.cmdTmpDelete.Enabled(True)
Gui.F_Template.cmdTmpDelete.Visible(True)
Gui.F_Template.cmdTmpDelete.Zorder(0)
Gui.F_Template.cmdTmpDelete.FontName("Tahoma")
Gui.F_Template.cmdTmpDelete.FontSize(8.25)
Gui.F_Template.lvwTemp.create(listview)
Gui.F_Template.lvwTemp.view(3)
Gui.F_Template.lvwTemp.addlistviewcolumn("Job",915,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Suffix",660,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Seq",1000,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("WC",660,0)
Gui.F_Template.lvwTemp.addlistviewcolumn("Description",2115,0)
Gui.F_Template.lvwTemp.size(5355,5055)
Gui.F_Template.lvwTemp.position(75,1305)
Gui.F_Template.lvwTemp.event(ItemClick,lvwtemp_itemclick)
Gui.F_Template.lvwTemp.Enabled(True)
Gui.F_Template.lvwTemp.Visible(True)
Gui.F_Template.lvwTemp.Zorder(0)
Gui.F_Template.lvwTemp.FontName("Tahoma")
Gui.F_Template.lvwTemp.FontSize(8)
Gui.F_Template.lvwTemp.Multiselect(False)
Gui.F_Template.lvwTemp.CheckBoxes(False)
Gui.F_Template.cmdTmpDeleteAll.create(button)
Gui.F_Template.cmdTmpDeleteAll.caption("Delete All")
Gui.F_Template.cmdTmpDeleteAll.size(1395,345)
Gui.F_Template.cmdTmpDeleteAll.position(90,6450)
Gui.F_Template.cmdTmpDeleteAll.event(Click,cmdtmpdeleteall_click)
Gui.F_Template.cmdTmpDeleteAll.defaultvalue("")
Gui.F_Template.cmdTmpDeleteAll.TabStop(True)
Gui.F_Template.cmdTmpDeleteAll.TabIndex(10)
Gui.F_Template.cmdTmpDeleteAll.Enabled(True)
Gui.F_Template.cmdTmpDeleteAll.Visible(True)
Gui.F_Template.cmdTmpDeleteAll.Zorder(0)
Gui.F_Template.cmdTmpDeleteAll.FontName("Tahoma")
Gui.F_Template.cmdTmpDeleteAll.FontSize(8.25)
Gui.F_Template.cmdTmpWC.Create(Button)
Gui.F_Template.cmdTmpWC.Size(345,375)
Gui.F_Template.cmdTmpWC.Position(5025,330)
Gui.F_Template.cmdTmpWC.Caption("^")
Gui.F_Template.cmdTmpWC.DefaultValue("")
Gui.F_Template.cmdTmpWC.Event(Click,cmdTmpAddWC_Click)
Gui.F_Template.cmdTmpWC.TabStop(True)
Gui.F_Template.cmdTmpWC.TabIndex(7)
Gui.F_Template.cmdTmpWC.Enabled(True)
Gui.F_Template.cmdTmpWC.Visible(True)
Gui.F_Template.cmdTmpWC.Zorder(0)
Gui.F_Template.cmdTmpWC.FontName("Tahoma")
Gui.F_Template.cmdTmpWC.FontSize(8.25)
Gui.F_Template.txtTmpWC.Create(TextBox,"",True,765,300,0,4110,375,True,0,"Arial",8,-2147483643,1)
Gui.F_Template.txtTmpWC.DefaultValue("")
Gui.F_Template.txtTmpWC.TabStop(True)
Gui.F_Template.txtTmpWC.TabIndex(6)
Gui.F_Template.lblSeq2.Create(Label,"Workcenter",True,1185,255,1,4050,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Template.lblSeq2.DefaultValue("")
Gui.F_Template.lblSeq2.BorderStyle(0)
Gui.fLogin..Create(BaseForm)
Gui.fLogin..Caption("Time Sheet Login")
Gui.fLogin..Size(4395,2280)
Gui.fLogin..MinX(0)
Gui.fLogin..MinY(0)
Gui.fLogin..Position(0,0)
Gui.fLogin..BackColor(-2147483633)
Gui.fLogin..MousePointer(0)
Gui.fLogin..Event(UnLoad,fLogin_UnLoad)
Gui.fLogin..AlwaysOnTop(False)
Gui.fLogin..FontName("Tahoma")
Gui.fLogin..FontSize(8.25)
Gui.fLogin..ControlBox(True)
Gui.fLogin..MaxButton(True)
Gui.fLogin..MinButton(True)
Gui.fLogin..Moveable(True)
Gui.fLogin..Sizeable(True)
Gui.fLogin..ShowInTaskBar(True)
Gui.fLogin..TitleBar(True)
Gui.fLogin.lbl1.Create(Label,"User Name :",True,1560,255,0,270,300,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lbl1.BorderStyle(0)
Gui.fLogin.txtUser.Create(TextBox,"",True,1680,390,0,2130,165,True,0,"Arial",12,-2147483643,1)
Gui.fLogin.txtUser.MaxLength(8)
Gui.fLogin.txtUser.Mask(">")
Gui.fLogin.lbl2.Create(Label,"Password : ",True,1605,255,0,270,720,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lbl2.BorderStyle(0)
Gui.fLogin.txtPassword.Create(TextBox,"",True,1680,390,0,2130,585,True,0,"Arial",12,-2147483643,1)
Gui.fLogin.txtPassword.PasswordChar("***********")
Gui.fLogin.cmdSignIn.Create(Button)
Gui.fLogin.cmdSignIn.Size(3555,450)
Gui.fLogin.cmdSignIn.Position(270,1125)
Gui.fLogin.cmdSignIn.Caption("Sign In")
Gui.fLogin.cmdSignIn.FontSize(12)
Gui.fLogin.cmdSignIn.Event(Click,cmdSignIn_Click)
Gui.fLogin.cmdSignIn.Enabled(True)
Gui.fLogin.cmdSignIn.Visible(True)
Gui.fLogin.cmdSignIn.Zorder(0)
Gui.fLogin.cmdSignIn.FontName("Tahoma")
Gui.fLogin.lblUsrName.Create(Label,"!",False,240,330,0,3870,255,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lblUsrName.ForeColor(255)
Gui.fLogin.lblUsrName.BorderStyle(0)
Gui.fLogin.lblPassWord.Create(Label,"!",False,240,330,0,3870,660,True,0,"Arial",12,-2147483633,0,0)
Gui.fLogin.lblPassWord.ForeColor(255)
Gui.fLogin.lblPassWord.BorderStyle(0)
Gui.FormMessageBox..Create(BaseForm)
Gui.FormMessageBox..Caption("Title")
Gui.FormMessageBox..Size(5715,2145)
Gui.FormMessageBox..MinX(0)
Gui.FormMessageBox..MinY(0)
Gui.FormMessageBox..Position(0,0)
Gui.FormMessageBox..AlwaysOnTop(True)
Gui.FormMessageBox..BackColor(-2147483633)
Gui.FormMessageBox..MaxButton(False)
Gui.FormMessageBox..MinButton(False)
Gui.FormMessageBox..MousePointer(0)
Gui.FormMessageBox..Sizeable(False)
Gui.FormMessageBox..Event(UnLoad,FormMessageBox_UnLoad)
Gui.FormMessageBox..FontName("Tahoma")
Gui.FormMessageBox..FontSize(8.25)
Gui.FormMessageBox..ControlBox(True)
Gui.FormMessageBox..Moveable(True)
Gui.FormMessageBox..ShowInTaskBar(True)
Gui.FormMessageBox..TitleBar(True)
Gui.FormMessageBox.lblMsgBox.Create(Label,"Message",True,5400,1245,0,105,165,True,2,"Arial",10,-2147483633,0,0)
Gui.FormMessageBox.lblMsgBox.ForeColor(16711680)
Gui.FormMessageBox.lblMsgBox.BorderStyle(0)
Gui.FormMessageBox.cmdMsgNo.Create(Button)
Gui.FormMessageBox.cmdMsgNo.Size(990,375)
Gui.FormMessageBox.cmdMsgNo.Position(4515,1425)
Gui.FormMessageBox.cmdMsgNo.Caption("No")
Gui.FormMessageBox.cmdMsgNo.Event(Click,cmdMsgNO_Click)
Gui.FormMessageBox.cmdMsgNo.Enabled(True)
Gui.FormMessageBox.cmdMsgNo.Visible(True)
Gui.FormMessageBox.cmdMsgNo.Zorder(0)
Gui.FormMessageBox.cmdMsgNo.FontName("Tahoma")
Gui.FormMessageBox.cmdMsgNo.FontSize(8.25)
Gui.FormMessageBox.cmdMsgYes.Create(Button)
Gui.FormMessageBox.cmdMsgYes.Size(990,375)
Gui.FormMessageBox.cmdMsgYes.Position(3390,1425)
Gui.FormMessageBox.cmdMsgYes.Caption("Yes")
Gui.FormMessageBox.cmdMsgYes.Event(Click,cmdMsgYes_Click)
Gui.FormMessageBox.cmdMsgYes.Enabled(True)
Gui.FormMessageBox.cmdMsgYes.Visible(True)
Gui.FormMessageBox.cmdMsgYes.Zorder(0)
Gui.FormMessageBox.cmdMsgYes.FontName("Tahoma")
Gui.FormMessageBox.cmdMsgYes.FontSize(8.25)
Gui.F_newNotes..Create(BaseForm)
Gui.F_newNotes..Caption("Job Seq Notes")
Gui.F_newNotes..Size(8730,6210)
Gui.F_newNotes..MinX(0)
Gui.F_newNotes..MinY(0)
Gui.F_newNotes..Position(0,0)
Gui.F_newNotes..AlwaysOnTop(False)
Gui.F_newNotes..FontName("Tahoma")
Gui.F_newNotes..FontSize(8.25)
Gui.F_newNotes..ControlBox(True)
Gui.F_newNotes..MaxButton(True)
Gui.F_newNotes..MinButton(True)
Gui.F_newNotes..MousePointer(0)
Gui.F_newNotes..Moveable(True)
Gui.F_newNotes..Sizeable(True)
Gui.F_newNotes..ShowInTaskBar(True)
Gui.F_newNotes..TitleBar(True)
Gui.F_newNotes..Event(UnLoad,F_newNotes_UnLoad)
Gui.F_newNotes.txtNewNotes.Create(TextboxM)
Gui.F_newNotes.txtNewNotes.Enabled(True)
Gui.F_newNotes.txtNewNotes.Visible(True)
Gui.F_newNotes.txtNewNotes.Zorder(0)
Gui.F_newNotes.txtNewNotes.Size(8580,5235)
Gui.F_newNotes.txtNewNotes.Position(75,420)
Gui.F_newNotes.txtNewNotes.FontName("Tahoma")
Gui.F_newNotes.txtNewNotes.FontSize(8.25)
Gui.F_newNotes.txtNewNotes.Anchor(15)
Gui.F_newNotes.cmdNotesOk.Create(Button)
Gui.F_newNotes.cmdNotesOk.Enabled(True)
Gui.F_newNotes.cmdNotesOk.Visible(True)
Gui.F_newNotes.cmdNotesOk.Zorder(0)
Gui.F_newNotes.cmdNotesOk.Size(1125,345)
Gui.F_newNotes.cmdNotesOk.Position(7515,30)
Gui.F_newNotes.cmdNotesOk.Caption("Save")
Gui.F_newNotes.cmdNotesOk.FontName("Tahoma")
Gui.F_newNotes.cmdNotesOk.FontSize(8.25)
Gui.F_newNotes.cmdNotesOk.Event(Click,cmdNotesOk_Click)
Gui.F_newNotes.cmdNotesOk.Anchor(9)
Gui.F_New_Line..Create(BaseForm)
Gui.F_New_Line..Caption("Job Seq Notes")
Gui.F_New_Line..Size(9435,6585)
Gui.F_New_Line..MinX(0)
Gui.F_New_Line..MinY(0)
Gui.F_New_Line..Position(0,0)
Gui.F_New_Line..AlwaysOnTop(False)
Gui.F_New_Line..FontName("Tahoma")
Gui.F_New_Line..FontSize(8.25)
Gui.F_New_Line..ControlBox(True)
Gui.F_New_Line..MaxButton(True)
Gui.F_New_Line..MinButton(True)
Gui.F_New_Line..MousePointer(0)
Gui.F_New_Line..Moveable(True)
Gui.F_New_Line..Sizeable(True)
Gui.F_New_Line..ShowInTaskBar(True)
Gui.F_New_Line..TitleBar(True)
Gui.F_New_Line..Event(UnLoad,F_New_Line_UnLoad)
Gui.F_New_Line.cmd_newOKLine.Create(Button)
Gui.F_New_Line.cmd_newOKLine.Enabled(True)
Gui.F_New_Line.cmd_newOKLine.Visible(True)
Gui.F_New_Line.cmd_newOKLine.Zorder(0)
Gui.F_New_Line.cmd_newOKLine.Size(1125,345)
Gui.F_New_Line.cmd_newOKLine.Position(8190,30)
Gui.F_New_Line.cmd_newOKLine.Caption("Save")
Gui.F_New_Line.cmd_newOKLine.FontName("Tahoma")
Gui.F_New_Line.cmd_newOKLine.FontSize(8.25)
Gui.F_New_Line.cmd_newOKLine.Event(Click,cmd_newOKLine_Click)
Gui.F_New_Line.cmd_newOKLine.Anchor(9)
Gui.F_New_Line.txt1.Create(TextboxM)
Gui.F_New_Line.txt1.Enabled(True)
Gui.F_New_Line.txt1.Visible(True)
Gui.F_New_Line.txt1.Zorder(0)
Gui.F_New_Line.txt1.Size(9285,5625)
Gui.F_New_Line.txt1.Position(60,420)
Gui.F_New_Line.txt1.FontName("Tahoma")
Gui.F_New_Line.txt1.FontSize(8.25)
Gui.F_New_Line.dtp1.Create(DatePicker)
Gui.F_New_Line.dtp1.Enabled(True)
Gui.F_New_Line.dtp1.Visible(True)
Gui.F_New_Line.dtp1.Zorder(0)
Gui.F_New_Line.dtp1.Size(1500,300)
Gui.F_New_Line.dtp1.Position(75,90)
Gui.F_New_Line.dtp1.CheckBox(False)
Gui.F_New_Line.dtp1.FontName("Tahoma")
Gui.F_New_Line.dtp1.FontSize(8.25)
Gui.F_New_Line.dtp1.Event(Change,dtp1_Change)
Gui.F_New_Line.chk1.Create(CheckBox)
Gui.F_New_Line.chk1.Enabled(True)
Gui.F_New_Line.chk1.Visible(True)
Gui.F_New_Line.chk1.Zorder(0)
Gui.F_New_Line.chk1.Size(1785,300)
Gui.F_New_Line.chk1.Position(1620,75)
Gui.F_New_Line.chk1.Caption("Set Date Job Notes")
Gui.F_New_Line.chk1.FontName("Tahoma")
Gui.F_New_Line.chk1.FontSize(8.25)
Gui.F_New_Line.chk1.Event(Change,chk1_Change)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
V.Global.sMessageBoxReturn.Declare(String)
Variable.Global.dDate.Declare(Date,1/1/1900)
Variable.Global.sDetl.Declare(String)
Variable.Global.sTA.Declare(String)
Variable.Global.iChk.Declare(Long,0)
Variable.Global.iRun.Declare(Long,0)
Variable.Global.sUser.Declare(String)
Variable.Global.bAdminMode.Declare(Boolean,False)
Variable.Global.iBIRUNID.Declare(Long,0)
Variable.Global.iLogID.Declare(Long,0)
Variable.Global.bSaveMsg.Declare(boolean,false)
Variable.Global.bReady.Declare(boolean,false)
v.Global.iRowId.Declare(Long,0)
Program.External.Include.Library("JB0455.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
'Coded by: MLA
'Project Start Date: 3/31/2011
'Notes:
' Northern Power
'GS Certified By: BCC
'8/20/2015

'Quote 7118 Modificaiton for Thielenhaus
'6/17/16
'TRT

'Modifed to 6574 by Ashwin S

'Modified 3/13/19 
'Trey S
'For Exergy Engineering
'Quote 11026-0
'Ticket EXE010-11020191348-7

'Modified 12/28/2021
'Alejandro ANazco
'For COBALT PRODUCT SOLUTIONS
'Quote 13291
'Ticket COB010-112420210720-0

'Modified 04/21/2021
'Alejandro ANazco
F.Intrinsic.Control.Try

v.Local.sSql.Declare
v.Local.sCaption.Declare

F.Intrinsic.Control.CallSub(SetIcon)

F.Intrinsic.Control.If(v.Caller.Hook,=,15710)
	
	Variable.Passed.000020.Set("Timesheet")
F.Intrinsic.Control.Elseif(v.Caller.Hook,=,15770)
	F.Intrinsic.string.build("Select Distinct GS_USER from USER_INFORMATION where company = '{0}' or company_specific = 0",v.caller.CompanyCode,v.Local.sSql)
	F.ODBC.Connection!conx.OpenCommonConnection
	F.Intrinsic.Control.try	
		F.Data.DataTable.CreateFromSQL("USERDT","CONX",v.Local.sSql,true)
	F.Intrinsic.Control.Catch
		F.Intrinsic.UI.Msgbox("Oops! Something went wrong. Please contact Global Shop Solutions.")
	F.Intrinsic.Control.Finally
		F.ODBC.Connection!conx.Close
	F.Intrinsic.Control.EndTry
	F.Intrinsic.Control.If(v.DataTable.USERDT.Exists)
		F.Data.DataView.Create("USERDT","USERVw",22)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CallSub(GetGSUserFromWindowsUser, "WindowsUser", V.System.UserName)
	
	F.Intrinsic.Control.If(V.Args.GSUser.Trim, =, "")
		GUI.fLogin..Show
	F.Intrinsic.Control.Else
		V.Global.sUser.Set(V.Args.GSUser.Trim)
		F.Intrinsic.Control.CallSub(PostSignIn)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.Control.CallSub(PostSignIn)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.GetGSUserFromWindowsUser.Start
'check the windows user when launched from the GUI. If there is a GS User tied to that open the timesheet for them
'Otherwise they need to sign in

F.Intrinsic.Control.Try
	
V.Local.sWindowsUser.Declare(String)
V.Local.sGSUser.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.bInString.Declare(Boolean)
V.Local.sMessage.Declare(String)
V.Local.sSplit.Declare(String)

V.Local.sWindowsUser.Set(V.Args.WindowsUser.Trim)
F.Intrinsic.String.Build("select USER_ID from USER_SECURITY where UPPER(WINDOW_USER) = '{0}'", V.Local.sWindowsUser.UCase, V.Local.sSQL)
F.ODBC.Connection!Com.OpenCommonConnection
F.ODBC.Connection!Com.ExecuteAndReturn(V.Local.sSQL, V.Local.sGSUser)
F.ODBC.Connection!Com.Close

F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.IsInString(V.Local.sGSUser, "#$#", True, V.Local.bInString)
F.Intrinsic.Control.If(V.Local.bInString)
	F.Intrinsic.String.Build("Warning: Multiple GS Users with the windows username {0}. User will need to sign in.", V.Local.sWindowsUser, V.Local.sMessage)
	F.Intrinsic.UI.Msgbox(V.Local.sMessage)
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Global.Security.GetUsernameFromID(V.Local.sGSUser, V.Local.sGSUser)
F.Intrinsic.Control.If(V.Local.sGSUser.IsNotNoReturn)
	F.Intrinsic.String.Split(V.Local.sGSUser, "*!*", V.Local.sSplit)
	V.Local.sGSUser.Set(V.Local.sSplit(0))
F.Intrinsic.Control.Else
	V.Local.sGSUser.Set("")
F.Intrinsic.Control.EndIf

F.Intrinsic.Variable.AddRV("GSUser", V.Local.sGSUser)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GetGSUserFromWindowsUser.End

Program.Sub.cmdSignIn_Click.Start
F.Intrinsic.Control.Try

v.Local.sFilter.Declare
v.Local.sPass.Declare
v.Local.sUser.Declare
v.Local.bLogin.Declare

GUI.fLogin..Enabled(False)
v.Local.sUser.Set(v.Screen.fLogin!txtUser.text)
v.Local.sPass.Set(v.Screen.fLogin!txtPassword.text)
F.Intrinsic.Control.If(v.Local.sUser.trim,=,"")
	F.Intrinsic.UI.Msgbox("Please enter a User Name to login.")
	GUI.fLogin.lblUsrName.Visible(True)
	GUI.fLogin..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	GUI.fLogin.lblUsrName.Visible(False)
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Build("GS_USER = '{0}'",v.Local.sUser.UCase,v.Local.sFilter)
F.Data.DataView.SetFilter("USERDT","USERVw",v.Local.sFilter)
F.Intrinsic.Control.If(v.DataView.USERDT!USERVw.RowCount,=,0)
	F.Intrinsic.UI.Msgbox("Please enter a Valid User Name to login.")
	GUI.fLogin.lblUsrName.Visible(True)
	GUI.fLogin..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	GUI.fLogin.lblUsrName.Visible(False)
F.Intrinsic.Control.EndIf

F.Global.Security.ValidateUser(v.Caller.CompanyCode,v.Local.sUser.UCase,v.Local.sPass,v.Local.bLogin)
F.Intrinsic.Control.If(v.Local.bLogin)
	GUI.fLogin.lblPassWord.Visible(False)
	GUI.fLogin..Visible(False)
	v.Global.sUser.set(v.Local.sUser.UCase)
	F.Intrinsic.Control.CallSub(PostSignIn)
F.Intrinsic.control.Else
	F.Intrinsic.UI.Msgbox("Password is Incorrect. Please enter a Valid Password.")
	GUI.fLogin.lblPassWord.Visible(True)
	GUI.fLogin..Enabled(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdSignIn_Click.End

Program.Sub.PostSignIn.Start
F.Intrinsic.Control.Try

F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,7200)
F.Intrinsic.Control.CallSub(Admin_mode)
F.Intrinsic.Control.CallSub(Dtpweek_change)

F.data.dictionary.CreateFromSQL("DescDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,DESCRIPTION from V_JOB_HEADER ")
F.Data.Dictionary.SetDefaultReturn("DescDict","")
F.data.dictionary.CreateFromSQL("FGDict","con","Select RTRIM(JOB) + RTRIM(SUFFIX) AS JS,PART from V_JOB_HEADER ")
F.Data.Dictionary.SetDefaultReturn("FGDict","")
F.Data.Dictionary.CreateFromSQL("dictSeqDesc", "Con", "Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(DESCRIPTION) as DESCRIPTION from V_JOB_OPERATIONS where LMO = 'L'")
F.Data.Dictionary.SetDefaultReturn("dictSeqDesc", "")

F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)

F.Intrinsic.Control.CallSub(Gridtitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

GUI.FormTimesheet..Show

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.PostSignIn.End

Program.Sub.fLogin_UnLoad.Start
F.Intrinsic.Control.Try

F.Intrinsic.Control.End

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.fLogin_UnLoad.End

Program.Sub.dtpweek_change.Start
F.Intrinsic.Control.Try

V.Local.dDate.Declare(Date)
'get the date value from the screen and compute the beginning of the week for that data. in this case we are looking for the Monday of that week
V.Local.dDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
F.Intrinsic.Date.BeginningOfWeek(V.Local.dDate,V.Local.dDate)

'set this as initial value
GUI.FormTimesheet.dtpWeek.Value(V.Local.dDate)

V.Global.dDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.dtpweek_change.End

Program.Sub.FormTimesheet_unload.Start
F.Intrinsic.Control.Try

V.Local.sRet.Declare(String)
V.Local.sSQL.Declare(String)
v.Local.bReady.Declare(Boolean)

F.Intrinsic.String.Build("Select Distinct(Flag_Ready) as Flag_Ready from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY JOB, SUFFIX, SEQ",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)

F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")
	'check against the ready flag. If it's ready marked as true we are going to disable the save and enable the print.
	'and if we are not in admin mode.
	F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
		F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValTrim!Flag_Ready,=,"True")
			V.Local.bReady.Set(True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.ODBC.con!rst.MoveNext
F.Intrinsic.Control.Loop
F.ODBC.con!rst.Close

'check to see if the save varaible is true. this means changes were made and it asks if the user wants to save changes before exiting the application
f.Intrinsic.Control.If(v.DataTable.dtTimesheet.RowCount,>,0,"AND",v.Global.bAdminMode,=,false,v.Global.bSaveMsg,=,true)
	f.Intrinsic.Control.If(V.Local.bReady,=,false)
		F.Intrinsic.UI.Msgbox("Do you wish to save existing data before exiting?","Save Data?",3,V.Local.sRet)
		F.Intrinsic.Control.If(v.Local.sRet,=,2)
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.ElseIf(v.Local.sRet,=,6)
			v.Global.bSaveMsg.Set(false)
			F.Intrinsic.Control.CallSub(cmdsave_click)	
			v.Global.bSaveMsg.Set(false)
		F.Intrinsic.Control.Else
			v.Global.bSaveMsg.Set(false)			
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.ODBC.Connection!con.Close
F.Intrinsic.Control.End

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.FormTimesheet_unload.End

Program.Sub.GridTitle.Start
F.Intrinsic.Control.Try

V.Local.sDate.Declare(String)
V.Local.dDate.Declare(String)
V.Local.iCol.Declare(Long)

'Set Table Header for Main Screen.
'set the header captions and column widths
F.Intrinsic.Control.BlockEvents
GUI.FormTimesheet.gsgcTimesheet.SuspendLayout

F.Intrinsic.String.Build("Sun: {0}",V.Global.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","MaxWidth", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Global.dDate,V.local.dDate)
F.Intrinsic.String.Build("Mon: {0}",V.local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","MaxWidth", 60)

F.Intrinsic.Date.DateAdd("D",1,V.local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Tues: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","MaxWidth", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Wed: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","MaxWidth", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Thur: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","MaxWidth", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Fri: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","MaxWidth", 60)

F.Intrinsic.Date.DateAdd("D",1,V.Local.dDate,V.Local.dDate)
F.Intrinsic.String.Build("Sat: {0}",V.Local.dDate.FORMATM/DD/YY,V.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","MaxWidth", 60)
V.Local.sDate.Append(" (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","caption",v.Local.sDate)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","MaxWidth", 60)

F.Intrinsic.Control.UnBlockEvents
GUI.FormTimesheet.gsgcTimesheet.ResumeLayout

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GridTitle.End

Program.Sub.cmdrefresh_click.Start
F.Intrinsic.Control.Try

v.Global.bSaveMsg.Set(false)
F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)
F.Intrinsic.Control.CallSub(Gridtitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdrefresh_click.End

Program.Sub.GridLoad.Start
F.Intrinsic.Control.Try

V.Local.sJSS.Declare(String)
V.Local.sJS.Declare(String)
V.Local.sJob.Declare(String)
V.Local.sSeq.Declare(String)
V.Local.sSuffix.Declare(String)
V.Local.sSql.Declare(String)
V.Local.iUB.Declare(Long)
V.Local.i.Declare(Long)
V.Local.iCheck.Declare(Long)
V.Local.bReady.Declare
v.Local.sWC.Declare(String)
V.Local.bUpdated.Declare(Boolean, False)

GUI.FormTimesheet.gsgcTimesheet.Visible(False)

V.Local.bReady.Set(False)
V.Local.bUpdated.Set(False)
F.Intrinsic.Control.BlockEvents
GUI.FormTimesheet.gsgcTimesheet.SuspendLayout

'check for updated records for that week. 
F.Intrinsic.String.Build("Select UPDATED from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' AND UPDATED = '1'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
F.ODBC.Connection!con.OpenRecordsetRO("rstChk",V.Local.sSql)
F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,true)
	F.Data.DataTable.Close("dtTimesheet")
F.Intrinsic.Control.EndIf

'if no updated records
F.Intrinsic.Control.If(V.ODBC.con!rstChk.EOF,=,True)
	'build empty datatable using filler values
	F.Intrinsic.String.Build("Select JOB, SUFFIX, SEQ,RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS,RTRIM(JOB) + RTRIM(SUFFIX) AS JS,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,RTRIM(' ') as WC, CAST(0 AS DOUBLE) AS SUN_HRS,CAST(' ' as LONGVARCHAR) as SUN_NOTES, CAST(0 AS DOUBLE) AS MON_HRS,CAST(' ' as LONGVARCHAR) as MON_NOTES, CAST(0 AS DOUBLE) AS TUES_HRS,CAST(' ' as LONGVARCHAR)  as TUES_NOTES, CAST(0 AS DOUBLE) AS WED_HRS,CAST(' ' as LONGVARCHAR)  as WED_NOTES, CAST(0 AS DOUBLE) AS THUR_HRS,CAST(' ' as LONGVARCHAR)  as THUR_NOTES, CAST(0 AS DOUBLE) AS FRI_HRS,CAST(' ' as LONGVARCHAR)  as FRI_NOTES, CAST(0 AS DOUBLE) AS SAT_HRS,CAST(' ' as LONGVARCHAR)  as SAT_NOTES,CAST(0 AS BIT) AS UPDATED,CAST(0 AS BIT) AS FLAG_READY,CAST('A' as  CHAR(1)) as Wrapper, CAST(' ' as LONGVARCHAR)  as JOB_NOTES  from GCG_6574_TIMSHT where UPPER(USER_ID) = 'XXXXXXX{0}' ORDER BY JOB,SUFFIX, SEQ",v.Ambient.null,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)

	'get all records fromso we can go and set thre ready flag
	F.Intrinsic.String.Build("Select * from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY JOB, SUFFIX, SEQ",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)

	F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")

		F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValTrim!Flag_Ready,=,"True")
			V.Local.bReady.Set(True)
		F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.If(V.ODBC.con!rst.FieldVal!UPDATED,=,"True")
			V.Local.bUpdated.Set(True)
		F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,True)
			
			'add row if exists
			F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,v.Local.sJSS)
			F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,v.Local.sJS)
			F.Data.DataTable.AddRow("dtTimesheet","JSS",v.Local.sJSS,"JS",v.Local.sJS,"Job",V.ODBC.con!rst.FieldValTrim!JOB,"Suffix",V.ODBC.con!rst.FieldValTrim!SUFFIX,"Seq",V.ODBC.con!rst.FieldValTrim!SEQ,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"SUN_NOTES",V.ODBC.con!rst.FieldVal!SUN_NOTES,"MON_NOTES",V.ODBC.con!rst.FieldVal!MON_NOTES,"TUES_NOTES",V.ODBC.con!rst.FieldVal!TUES_NOTES,"WED_NOTES",V.ODBC.con!rst.FieldVal!WED_NOTES,"THUR_NOTES",V.ODBC.con!rst.FieldVal!THUR_NOTES,"FRI_NOTES",V.ODBC.con!rst.FieldVal!FRI_NOTES,"SAT_NOTES",V.ODBC.con!rst.FieldVal!SAT_NOTES,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"WRAPPER","A", "JOB_NOTES", V.ODBC.con!rst.FieldVal!JOB_NOTES)

		F.Intrinsic.Control.Else
			'create dtTimesheet
			F.Intrinsic.String.Build("Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS, RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,SUN_HRS,SUN_NOTES, MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' AND JOB = '{2}' AND SUFFIX = '{3}' AND SEQ = '{4}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sSql)
			F.DATA.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)

		F.Intrinsic.Control.EndIf

		F.ODBC.con!rst.MoveNext
	F.Intrinsic.Control.Loop
	F.ODBC.con!rst.Close

	GUI.FormTimesheet.cmdSave.Enabled(True)
	GUI.FormTimesheet.cmdAdd.Enabled(True)
	GUI.FormTimesheet.cmdFrmTemp.Enabled(True)
	GUI.FormTimesheet.cmdUpdate.Enabled(True)
	GUI.FormTimesheet.cmdAddJobBrows.Enabled(True)
	GUI.FormTimesheet.cmdSave.Enabled(True)
	GUI.FormTimesheet.cmdAddSeqBrows.Enabled(True)
	GUI.FormTimesheet.gsgcTimesheet.Enabled(True)
F.Intrinsic.Control.Else
	'if there are updated records
	F.Intrinsic.String.Build("Select Distinct(Flag_Ready) as Flag_Ready, UPDATED from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY JOB, SUFFIX, SEQ",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)
	'set ready flag to enable ready button
	F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")

		F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
			F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValTrim!Flag_Ready,=,"True")

				V.Local.bReady.Set(True)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.ODBC.con!rst.FieldVal!UPDATED,=,"True")
				V.Local.bUpdated.Set(True)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		F.ODBC.con!rst.MoveNext
	F.Intrinsic.Control.Loop
	F.ODBC.con!rst.Close
	F.Intrinsic.String.Build("Select * from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' ORDER BY JOB,SUFFIX, SEQ",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)

	F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,"True")
		F.Intrinsic.Control.If(v.DataTable.dtTimesheet.exists,=,True)
			F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,v.Local.sJSS)
			F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,v.Local.sJS)
			F.Data.DataTable.AddRow("dtTimesheet","JSS",v.Local.sJSS,"JS",v.Local.sJS,"Job",V.ODBC.con!rst.FieldValTrim!JOB,"Suffix",V.ODBC.con!rst.FieldValTrim!SUFFIX,"SEQ",V.ODBC.con!rst.FieldValTrim!SEQ,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"WRAPPER","A", "JOB_NOTES", v.ODBC.con!rst.FieldVal!JOB_NOTES)

		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) AS JSS,RTRIM(JOB) + RTRIM(SUFFIX) AS JS, JOB, SUFFIX, SEQ,RTRIM(' ') as DESCRIPTION,RTRIM(' ') as PART,WC,MON_HRS,MON_NOTES, TUES_HRS,TUES_NOTES, WED_HRS,WED_NOTES, THUR_HRS,THUR_NOTES, FRI_HRS,FRI_NOTES, SAT_HRS,SAT_NOTES,SUN_HRS,SUN_NOTES,UPDATED,FLAG_READY,CAST('A' as CHAR(1)) as Wrapper, JOB_NOTES from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' AND JOB = '{2}' AND SUFFIX = '{3}' AND SEQ = '{4}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sSql)
			F.DATA.DataTable.CreateFromSQL("dtTimesheet","con",V.Local.sSql,true)

		F.Intrinsic.Control.EndIf

		F.ODBC.con!rst.MoveNext
	F.Intrinsic.Control.Loop

	F.ODBC.con!rst.Close

	F.Intrinsic.Control.If(v.DataTable.dtTimesheet.RowCount,=,0)

		GUI.FormTimesheet.cmdSave.Enabled(False)
		GUI.FormTimesheet.cmdUpdate.Enabled(False)
		GUI.FormTimesheet.cmdAddJobBrows.Enabled(False)
		GUI.FormTimesheet.cmdSave.Enabled(False)
		GUI.FormTimesheet.cmdAddSeqBrows.Enabled(False)
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.EndIf
F.ODBC.con!rstChk.Close

F.Intrinsic.Control.If(V.Local.bReady)
	GUI.FormTimesheet.cmdSave.Enabled(False)
	GUI.FormTimesheet.cmdAdd.Enabled(False)
	GUI.FormTimesheet.cmdUpdate.Enabled(True)
	GUI.FormTimesheet.cmdFrmTemp.Enabled(False)
	GUI.FormTimesheet.cmdPrint.Enabled(True)
	GUI.FormTimesheet.cmdReady.Enabled(False)
	GUI.FormTimesheet.cmdUnlock.Enabled(True)
	F.Intrinsic.Control.If(V.Global.bAdminMode.Not)
		GUI.FormTimesheet.gsgcTimesheet.Enabled(False)
	F.Intrinsic.Control.Else
		GUI.FormTimesheet.gsgcTimesheet.Enabled(True)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	GUI.FormTimesheet.gsgcTimesheet.Enabled(True)
	GUI.FormTimesheet.cmdUpdate.Enabled(False)
	GUI.FormTimesheet.cmdReady.Enabled(True)
	GUI.FormTimesheet.cmdUnlock.Enabled(False)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.bUpdated)
	GUI.FormTimesheet.cmdSave.Enabled(False)
	GUI.FormTimesheet.cmdAdd.Enabled(False)
	GUI.FormTimesheet.cmdUpdate.Enabled(False)
	GUI.FormTimesheet.cmdFrmTemp.Enabled(False)
	GUI.FormTimesheet.cmdPrint.Enabled(True)
	GUI.FormTimesheet.cmdReady.Enabled(False)
	GUI.FormTimesheet.cmdUnlock.Enabled(False)
	GUI.FormTimesheet.gsgcTimesheet.Enabled(False)
F.Intrinsic.Control.Else

F.Intrinsic.Control.EndIf

F.Data.Datatable.FillFromDictionary("dtTimesheet","DescDict","JS","Description")
F.Data.Datatable.FillFromDictionary("dtTimesheet","FGDict","JS","Part")

F.Data.DataTable.AddColumn("dtTimesheet", "SEQ_DESCRIPTION", "String")
F.Data.Datatable.FillFromDictionary("dtTimesheet","dictSeqDesc", "JSS", "SEQ_DESCRIPTION")

F.Data.DataTable.AddColumn("dtTimesheet","Delete","String")

F.Data.DataTable.AddExpressionColumn("dtTimesheet", "JOB_SUM", "Float", "MON_HRS + TUES_HRS + WED_HRS + THUR_HRS + FRI_HRS + SAT_HRS + SUN_HRS")

F.Data.DataView.Create("dtTimesheet","dvTimesheet",22)

F.Intrinsic.Control.CallSub(LoadGridJobTime)

F.Data.DataTable.AddColumn("dtTimesheet", "SUNDAY_HOURS_EDIT", "String", "0:00")
F.Data.DataTable.AddColumn("dtTimesheet", "MONDAY_HOURS_EDIT", "String", "0:00")
F.Data.DataTable.AddColumn("dtTimesheet", "TUESDAY_HOURS_EDIT", "String", "0:00")
F.Data.DataTable.AddColumn("dtTimesheet", "WEDNESDAY_HOURS_EDIT", "String", "0:00")
F.Data.DataTable.AddColumn("dtTimesheet", "THURSDAY_HOURS_EDIT", "String", "0:00")
F.Data.DataTable.AddColumn("dtTimesheet", "FRIDAY_HOURS_EDIT", "String", "0:00")
F.Data.DataTable.AddColumn("dtTimesheet", "SATURDAY_HOURS_EDIT", "String", "0:00")
F.Data.DataTable.AddColumn("dtTimesheet", "JOB_TOTAL_TIME", "String", "0:00")


v.Local.sSQL.Set("select distinct MACHINE from WORKCENTERS")
F.data.DataTable.CreateFromSQL("WCDT","con",v.Local.sSQL)
F.Data.Dataview.Create("WCDT","WCDTVW",22)
F.data.DataView.ToString("WCDT","WCDTVW","MACHINE","@!@","*!*",v.Local.sWC)
F.Data.DataView.Close("WCDT","WCDTVW")
F.Data.DataTable.Close("WCDT")

F.Intrinsic.Control.CallSub(CalculateAllTimeColumns)

GUI.FormTimesheet.gsgcTimesheet.AddGridviewFromDataview("gvTimesheet","dtTimesheet","dvTimesheet")

GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","OptionsViewRowAutoHeight",False)
GUI.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","ColumnPanelRowHeight",40)
Gui.FormTimesheet.gsgcTimesheet.SetGridviewProperty("gvTimesheet","OptionsViewColumnAutoWidth", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskType", "RegEx")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskType", "RegEx")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskType", "RegEx")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskType", "RegEx")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskType", "RegEx")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskType", "RegEx")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderFontBold", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "AllowEdit", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "ReadOnly", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskType", "RegEx")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMask", "[0-9]+:[0-5][0-9]")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "EditMaskAsDisplayFormat", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderForeColor", V.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "HeaderWordWrap", "Wrap")

'Addeed By Alejandro
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","caption","Job Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","readonly", True)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","allowedit", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES","MaxWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_NOTES", "HeaderWordWrap", "Wrap")
'End Added by alejandro

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","visible","false")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JS","visible","false")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Wrapper","visible","False")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","Caption", "Updated")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","visible","True")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","UPDATED","allowedit", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FLAG_READY","visible","false")
GUI.FormTimesheet.gsgcTimesheet.ColumnEdit("gvTimesheet","Delete","EditorButton","Delete")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","MinWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","MaxWidth", 60)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","allowedit", false)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","caption","Job")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","MinWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","MaxWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","caption","Job Total (Decimal)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_SUM","MaxWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_SUM", "DisplayCustomNumeric", False)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet", "JOB_SUM", "Visible", "0.00")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","caption","Job Total")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","caption","Job SS")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JSS","MinWidth", 80)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","caption","Suffix")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","MinWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Suffix","MaxWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","visible","True")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","caption","Seq")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","MinWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Seq","MaxWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","caption","Description (Job)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","MinWidth", 110)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","caption","Description (Seq)")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","MinWidth", 110)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","caption","Part/Project")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","readonly", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","allowedit", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","PART","MinWidth", 80)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","caption","Work Center")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.ColumnEdit("gvTimesheet","WC","Dropdownlist",v.Local.sWC)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","MinWidth", 50)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","MaxWidth", 50)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_HRS", "Visible", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","caption","Sun Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_HRS", "Visible", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","caption","Mon Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_HRS", "Visible", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","caption","Tues Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_HRS", "Visible", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","caption","Wed Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_HRS", "Visible", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","caption","Th Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_HRS", "Visible", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","caption","Fri Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","HeaderWordWrap", "Wrap")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_HRS", "Visible", False)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","headerforecolor", v.Color.PRI-GSS-00)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","headerfontbold", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","caption","Sat Notes")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","readonly", false)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","allowedit", true)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","MinWidth", 70)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","MaxWidth", 70)

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SAT_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUN_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MON_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUES_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WED_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THUR_NOTES","Visible", "False")
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRI_NOTES","Visible", "False")

GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB","VisibleIndex", 0)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUFFIX","VisibleIndex", 1)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Description","VisibleIndex", 2)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SEQ","VisibleIndex", 3)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","seq_Description","VisibleIndex", 4)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Part","VisibleIndex", 5)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WC","VisibleIndex", 6)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SUNDAY_HOURS_EDIT","VisibleIndex", 7)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","MONDAY_HOURS_EDIT","VisibleIndex", 8)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","TUESDAY_HOURS_EDIT","VisibleIndex", 9)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","WEDNESDAY_HOURS_EDIT","VisibleIndex", 10)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","THURSDAY_HOURS_EDIT","VisibleIndex", 11)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","FRIDAY_HOURS_EDIT","VisibleIndex", 12)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","SATURDAY_HOURS_EDIT","VisibleIndex", 13)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","JOB_TOTAL_TIME","VisibleIndex", 14)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Updated","VisibleIndex", 15)
GUI.FormTimesheet.gsgcTimesheet.SetColumnProperty("gvTimesheet","Delete","VisibleIndex", 16)

GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "SUNDAY_HOURS_EDIT", "Condition1", "NotEqual", "0:00")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "SUNDAY_HOURS_EDIT", "Condition1", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "MONDAY_HOURS_EDIT", "Condition2", "NotEqual", "0:00")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "MONDAY_HOURS_EDIT", "Condition2", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "TUESDAY_HOURS_EDIT", "Condition3", "NotEqual", "0:00")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "TUESDAY_HOURS_EDIT", "Condition3", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "Condition4", "NotEqual", "0:00")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "WEDNESDAY_HOURS_EDIT", "Condition4", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "THURSDAY_HOURS_EDIT", "Condition5", "NotEqual", "0:00")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "THURSDAY_HOURS_EDIT", "Condition5", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "FRIDAY_HOURS_EDIT", "Condition6", "NotEqual", "0:00")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "FRIDAY_HOURS_EDIT", "Condition6", "FontBold", True)
GUI.FormTimesheet.gsgcTimesheet.AddStyleFormatCondition("gvTimesheet", "SATURDAY_HOURS_EDIT", "Condition7", "NotEqual", "0:00")
GUI.FormTimesheet.gsgcTimesheet.SetStyleFormatConditionProperty("gvTimesheet", "SATURDAY_HOURS_EDIT", "Condition7", "FontBold", True)

GUI.FormTimesheet.gsgcTimesheet.MainView("gvTimesheet")
GUI.FormTimesheet.gsgcTimesheet.Visible(True)
F.Intrinsic.Control.UnBlockEvents
GUI.FormTimesheet.gsgcTimesheet.ResumeLayout

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.GridLoad.End

Program.Sub.ComputeTotals.Start
F.Intrinsic.Control.Try

v.Local.fMonHrs.Declare(float)
v.Local.fTuesHrs.Declare(float)
v.Local.fWedHrs.Declare(float)
v.Local.fThurHrs.Declare(float)
v.Local.fFriHrs.Declare(float)
v.Local.fSatHrs.Declare(float)
v.Local.fSunHrs.Declare(float)
v.Local.fTotHrs.Declare(float)
v.Local.sHold.Declare(String)
V.Local.fTemp.Declare(Float)
V.Local.sTemp.Declare(String)
V.Local.fHours1.Declare(Float)
V.Local.fHours2.Declare(Float)
V.Local.fHours3.Declare(Float)
V.Local.fUnrounded.Declare(Float)
V.Local.iCounter.Declare(Long)
V.Local.sTime.Declare(String)

V.Local.sTime.Redim(0, 6)
V.Local.fUnrounded.Redim(0, 7)

'computes the total hours and loads them onto text boxes to the side
F.Data.DataView.ToDataTable("dtTimesheet","dvTimesheet","CompDT")
F.Intrinsic.Control.If(v.DataTable.CompDT.RowCount,<>,0)

	F.Data.DataTable.Compute("CompDT","Sum(SUN_HRS)","",V.Local.fUnrounded(0))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(0), 4, V.Local.fSunHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(0))
	GUI.FormTimesheet.txtSunHrs.Text(V.Args.Time)
	V.Local.sTime(0).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(MON_HRS)","",V.Local.fUnrounded(1))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(1), 4, V.Local.fMonHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(1))
	GUI.FormTimesheet.txtMonHrs.Text(V.Args.Time)
	V.Local.sTime(1).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(TUES_HRS)","",V.Local.fUnrounded(2))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(2), 4, V.Local.fTuesHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(2))
	GUI.FormTimesheet.txtTuesHrs.Text(V.Args.Time)
	V.Local.sTime(2).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(WED_HRS)","",V.Local.fUnrounded(3))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(3), 4, V.Local.fWedHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(3))
	GUI.FormTimesheet.txtWedHrs.Text(V.Args.Time)
	V.Local.sTime(3).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(THUR_HRS)","",V.Local.fUnrounded(4))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(4), 4, V.Local.fThurHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(4))
	GUI.FormTimesheet.txtThurHrs.Text(V.Args.Time)
	V.Local.sTime(4).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(FRI_HRS)","",V.Local.fUnrounded(5))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(5), 4, V.Local.fFriHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(5))
	GUI.FormTimesheet.txtFriHrs.Text(V.Args.Time)
	V.Local.sTime(5).Set(V.Args.Time)
	
	F.Data.DataTable.Compute("CompDT","Sum(SAT_HRS)","",V.Local.fUnrounded(6))
	'F.Intrinsic.Math.Round(V.Local.fUnrounded(6), 4, V.Local.fSatHrs)
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fUnrounded(6))
	GUI.FormTimesheet.txtSatHrs.Text(V.Args.Time)
	V.Local.sTime(6).Set(V.Args.Time)
	
	'F.Intrinsic.math.Add(v.Local.fSunHrs,v.Local.fMonHrs,v.Local.fTuesHrs,v.Local.fWedHrs,v.Local.fThurHrs,v.Local.fFriHrs,v.Local.fSatHrs,v.Local.fTotHrs)
	'F.Intrinsic.Math.Round(V.Local.fTotHrs, 4, V.Local.fTotHrs)
	V.Local.fTotHrs.Set(0)
	F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sTime.UBound, 1)
		F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Local.sTime(V.Local.iCounter))
		F.Intrinsic.Math.Add(V.Local.fTotHrs, V.Args.Decimal, V.Local.fTotHrs)
	F.Intrinsic.Control.Next(V.Local.iCounter)
	'F.Intrinsic.Math.Add(V.Local.fUnrounded(0), V.Local.fUnrounded(1), V.Local.fUnrounded(2), V.Local.fUnrounded(3), V.Local.fUnrounded(4), V.Local.fUnrounded(5), V.Local.fUnrounded(6), V.Local.fTotHrs)
	
	F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotHrs)
	GUI.FormTimesheet.txtTotHrs.Text(V.Args.Time)
	
	F.Data.DataTable.Close("CompDT")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(LoadClockInTime)

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsMon.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtMonHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtMonHrs.BackColor(V.Color.Pink)
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsTues.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtTuesHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtTuesHrs.BackColor(V.Color.Pink)
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsWed.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtWedHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtWedHrs.BackColor(V.Color.Pink)
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsThur.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtThurHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtThurHrs.BackColor(V.Color.Pink)
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsFri.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtFriHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtFriHrs.BackColor(V.Color.Pink)
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsSat.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtSatHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtSatHrs.BackColor(V.Color.Pink)
F.Intrinsic.Control.EndIf

V.Local.sTemp.Set(V.Screen.FormTimesheet!lblClockHrsSun.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtSunHrs.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtSunHrs.BackColor(V.Color.Pink)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(LoadJobTime)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtHoursTA.Text.Trim)
V.Local.fHours1.Set(V.Args.Decimal)
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtTotHrs.Text.Trim)
V.Local.fHours2.Set(V.Args.Decimal)
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtGUIHours.Text.Trim)
V.Local.fHours3.Set(V.Args.Decimal)

F.Intrinsic.Math.Add(V.Local.fHours2, V.Local.fHours3, V.Local.fTemp)
F.Intrinsic.Math.Sub(V.Local.fHours1, V.Local.fTemp, V.Local.fTemp)
F.Intrinsic.Math.Sub(0, V.Local.fTemp, V.Local.fTemp)
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTemp)
GUI.FormTimesheet.txtHoursBalance.Text(V.Args.Time)

V.Local.sTemp.Set(V.Screen.FormTimesheet!txtHoursBalance.Caption)
F.Intrinsic.Control.If(V.Local.sTemp, =, "0:00")
	GUI.FormTimesheet.txtHoursBalance.BackColor(12648384)
F.Intrinsic.Control.Else
	GUI.FormTimesheet.txtHoursBalance.BackColor(V.Color.Pink)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.ComputeTotals.End

Program.Sub.LoadClockInTime.Start
'get the actual time and attendance clock in time for the selected employee/week

F.Intrinsic.Control.Try

V.Local.sEmployee.Declare(String)
V.Local.dStartDate.Declare(Date)
V.Local.dEndDate.Declare(Date)
V.Local.sSQL.Declare(String)
V.Local.sMessage.Declare(String)
V.Local.iCounter.Declare(Long)
V.Local.dInTemp.Declare(Date)
V.Local.dOutTemp.Declare(Date)
V.Local.iMinutes.Declare(Long)
V.Local.iTotalMinutes.Declare(Long)
V.Local.iHours.Declare(Long)
V.Local.fHours.Declare(Float)
V.Local.fTotalHours.Declare(Float)
V.Local.dDate.Declare(Date)
V.Local.sFilter.Declare(String)
V.Local.fTemp.Declare(Float)
V.Local.sTemp.Declare(String)
V.Local.sMonday.Declare(String)
V.Local.sTuesday.Declare(String)
V.Local.sWednesday.Declare(String)
V.Local.sThursday.Declare(String)
V.Local.sFriday.Declare(String)
V.Local.sSaturday.Declare(String)
V.Local.sSunday.Declare(String)
V.Local.sTotal.Declare(String)

'get employee
F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Local.sEmployee.Set(V.Screen.FormTimesheet!txtEmployee.Text.Trim)
F.Intrinsic.Control.Else
	F.Global.Security.GetEmpNoFromUser(V.Global.sUser, V.Local.sEmployee)
	F.Intrinsic.Control.If(V.Local.sEmployee.IsNoReturn)
		F.Intrinsic.String.Build("No employee tied to the user '{0}', clock in time will not be pulled in.", V.Global.sUser, V.Local.sMessage)
		F.Intrinsic.UI.Msgbox(V.Local.sMessage)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'get date range
V.Local.dStartDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
F.Intrinsic.Date.DateAdd("D", 6, V.Local.dStartDate, V.Local.dEndDate)

'get data
F.Intrinsic.String.Build("select CHARGE_DATE, DATE_IN, DATE_OUT, IsNull(HOURS_HH, 0) as HOURS_HH, IsNull(HOURS_MM, 0) as HOURS_MM, OUT_TS_MIN, IN_TS_MIN, TIME_IN, TIME_OUT from V_TIME_ATTENDANCE where CHARGE_DATE between '{0}' and '{1}' and EMPLOYEE = '{2}'", V.Local.dStartDate.FormatYYYY-MM-DD, V.Local.dEndDate.FormatYYYY-MM-DD, V.Local.sEmployee, V.Local.sSQL)
F.Data.DataTable.CreateFromSQL("dtClock", "Con", V.Local.sSQL)

'if still clocked in will need to calculate
'currently I'm assuming there's no overnight
F.Data.DataTable.AddColumn("dtClock", "Hours", "Long", 0)
F.Data.DataTable.AddColumn("dtClock", "Minutes", "Long", 0)
F.Data.DataTable.AddColumn("dtClock", "Curr_Hours_Float", "Float", 0)
F.Data.DataTable.AddColumn("dtClock", "Total_Minutes", "Long", 0)
F.Data.DataView.Create("dtClock", "dvClockedIn", 22, "DATE_OUT = '1900-01-01'", "")
F.Intrinsic.Control.For(V.Local.iCounter, 0, V.DataView.dtClock!dvClockedIn.RowCount--, 1)
	V.Local.dInTemp.Set(V.DataView.dtClock!dvClockedIn(V.Local.iCounter).Time_In!FieldVal)
	V.Local.dOutTemp.Set(V.Ambient.Time)
	F.Intrinsic.Date.DateDiff("N", V.Local.dInTemp, V.Local.dOutTemp, V.Local.iTotalMinutes)
	F.Intrinsic.Math.Mod(V.Local.iTotalMinutes, 60, V.Local.iMinutes)
	F.Intrinsic.Math.Div(V.Local.iTotalMinutes, 60, V.Local.fHours)
	F.Intrinsic.Math.Round(V.Local.fHours, 0, V.Local.iHours)
	'F.Intrinsic.Math.Round(V.Local.fHours, 4, V.Local.fHours)
	F.Data.DataView.SetValue("dtClock", "dvClockedIn", V.Local.iCounter, "Total_Minutes", V.Local.iTotalMinutes, "Hours", V.Local.iHours, "Minutes", V.Local.iMinutes, "Curr_Hours_Float", V.Local.fHours)
	
F.Intrinsic.Control.Next(V.Local.iCounter)
F.Data.DataView.Close("dtClock", "dvClockedIn")

F.Data.DataTable.AddExpressionColumn("dtClock", "Prev_Hours_Float", "Float", "[HOURS_HH] + ([HOURS_MM] / 60)")
F.Data.DataTable.AddExpressionColumn("dtClock", "Hours_Float", "Float", "[Prev_Hours_Float] + [Curr_Hours_Float]")

F.Data.DataTable.AddColumn("dtClock", "FInal_Time", "Float")
F.Data.DataTable.SetValueFormat("dtClock", -1, "Hours_Float", "Final_Time", "##############.00##")

'create job time datatable to remove it from the sum
F.Intrinsic.String.Build("select DATE_SEQUENCE, EMPL, SUM(HOURS_WORKED) HOURS from V_JOB_DETAIL where EMPL = '{0}' and DATE_SEQUENCE between '{1}' and '{2}' group by DATE_SEQUENCE, EMPL", V.Local.sEmployee, V.Local.dStartDate.FormatYYYY-MM-DD, V.Local.dEndDate.FormatYYYY-MM-DD, V.Local.sSQL)
F.Data.DataTable.CreateFromSQL("dtJobDetail", "con", V.Local.sSQL)
F.Data.DataView.Create("dtJobDetail", "dvJobDetail", 22)

V.Local.dDate.Set(V.Local.dStartDate)
V.Local.fTotalHours.Redim(0, 7)
F.Intrinsic.Control.For(V.Local.iCounter, 0, 6, 1)
	F.Intrinsic.String.Build("CHARGE_DATE = '{0}'", V.Local.dDate, V.Local.sFilter)
	F.Data.DataTable.Compute("dtClock", "Sum(Final_Time)", V.Local.sFilter, V.Local.fHours)
	
	'subtract job hours
	F.Intrinsic.String.Build("DATE_SEQUENCE = '{0}'", V.Local.dDate, V.Local.sFilter)
	F.Data.DataView.SetFilter("dtJobDetail", "dvJobDetail", V.Local.sFilter)
	F.Intrinsic.Control.If(V.DataView.dtJobDetail!dvJobDetail.RowCount, >, 0)
		F.Intrinsic.Math.Sub(V.Local.fHours, V.DataView.dtJobDetail!dvJobDetail(0).HOURS!FieldValFloat, V.Local.fHours)
	F.Intrinsic.Control.EndIf
	
	'F.Intrinsic.Math.Round(V.Local.fHours, 4, V.Local.fHours)
	V.Local.fTotalHours(V.Local.iCounter).Set(V.Local.fHours)
	F.Intrinsic.Date.DateAdd("d", 1, V.Local.dDate, V.Local.dDate)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Data.DataTable.Compute("dtClock", "Sum(Final_Time)", "", V.Local.fHours)
'F.Intrinsic.Math.Round(V.Local.fHours, 4, V.Local.fHours)
V.Local.fTotalHours(7).Set(V.Local.fHours)

F.Data.DataView.Close("dtJobDetail", "dvJobDetail")
F.Data.DataTable.Close("dtJobDetail")

'Exergy wants the clock in time to count down to 0 (cancel out) as bucket time is entered
F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtSunHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(0), V.Local.fTemp, V.Local.fTotalHours(0))
F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(0), V.Local.fTotalHours(0))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(0), 4, V.Local.fTotalHours(0))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(0))
V.Local.sSunday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtMonHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(1), V.Local.fTemp, V.Local.fTotalHours(1))
F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(1), V.Local.fTotalHours(1))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(1), 4, V.Local.fTotalHours(1))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(1))
V.Local.sMonday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtTuesHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(2), V.Local.fTemp, V.Local.fTotalHours(2))
F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(2), V.Local.fTotalHours(2))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(2), 4, V.Local.fTotalHours(2))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(2))
V.Local.sTuesday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtWedHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(3), V.Local.fTemp, V.Local.fTotalHours(3))
F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(3), V.Local.fTotalHours(3))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(3), 4, V.Local.fTotalHours(3))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(3))
V.Local.sWednesday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtThurHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(4), V.Local.fTemp, V.Local.fTotalHours(4))
F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(4), V.Local.fTotalHours(4))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(4), 4, V.Local.fTotalHours(4))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(4))
V.Local.sThursday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtFriHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(5), V.Local.fTemp, V.Local.fTotalHours(5))
F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(5), V.Local.fTotalHours(5))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(5), 4, V.Local.fTotalHours(5))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(5))
V.Local.sFriday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.Screen.FormTimesheet!txtSatHrs.Text.Trim)
'F.Intrinsic.Math.Sub(0, V.Args.Decimal, V.Local.fTemp)
'F.Intrinsic.Math.Add(V.Local.fTotalHours(6), V.Local.fTemp, V.Local.fTotalHours(6))
F.Intrinsic.Math.Sub(V.Args.Decimal, V.Local.fTotalHours(6), V.Local.fTotalHours(6))
'F.Intrinsic.Math.Round(V.Local.fTotalHours(6), 4, V.Local.fTotalHours(6))
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(6))
V.Local.sSaturday.Set(V.Args.Time)

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fTotalHours(7))
V.Local.sTotal.Set(V.Args.Time)

GUI.FormTimesheet.lblClockHrsMon.Caption(V.Local.sMonday)
GUI.FormTimesheet.lblClockHrsTues.Caption(V.Local.sTuesday)
GUI.FormTimesheet.lblClockHrsWed.Caption(V.Local.sWednesday)
GUI.FormTimesheet.lblClockHrsThur.Caption(V.Local.sThursday)
GUI.FormTimesheet.lblClockHrsFri.Caption(V.Local.sFriday)
GUI.FormTimesheet.lblClockHrsSat.Caption(V.Local.sSaturday)
GUI.FormTimesheet.lblClockHrsSun.Caption(V.Local.sSunday)

GUI.FormTimesheet.txtHoursTA.Text(V.Local.sTotal)

F.Data.DataTable.Close("dtClock")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.LoadClockInTime.End

Program.Sub.EmptyTotals.Start
F.Intrinsic.Control.Try

GUI.FormTimesheet.txtSunHrs.Text("0:00")
GUI.FormTimesheet.txtMonHrs.Text("0:00")
GUI.FormTimesheet.txtTuesHrs.Text("0:00")
GUI.FormTimesheet.txtWedHrs.Text("0:00")
GUI.FormTimesheet.txtThurHrs.Text("0:00")
GUI.FormTimesheet.txtFriHrs.Text("0:00")
GUI.FormTimesheet.txtSatHrs.Text("0:00")
GUI.FormTimesheet.txtTotHrs.Text("0:00")
GUI.FormTimesheet.txtHoursTA.Text("0:00")
GUI.FormTimesheet.txtHoursBalance.Text("0:00")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.EmptyTotals.End

Program.Sub.cmdaddjobbrows_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sJob.Declare(String)

V.Local.sTitle.Set("Job*!*Suffix*!*Part*!*Description")
V.Local.sWidth.Set("1200*!*700*!*2200*!*2700")
V.Local.sJob.Set(v.screen.FormTimesheet!txtAJob.text)
F.Intrinsic.Control.If(V.Local.sJob.trim,<>,"")
	V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")
	F.Intrinsic.String.Build("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER where job >= '{0}' ORDER BY JOB, SUFFIX",v.screen.FormTimesheet!txtAJob.text.trim,v.Local.sSql)
F.Intrinsic.Control.Else
	V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select Job","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.FormTimesheet.txtAJob.Text(V.Local.sRet(0))
	GUI.FormTimesheet.txtASufF.Text(V.Local.sRet(1))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdaddjobbrows_click.End

Program.Sub.cmdaddseqbrows_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sWC.Declare(String)

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtAJob.Text,=,"")
	F.Intrinsic.UI.Msgbox("No job selected!","Select Job")
F.Intrinsic.Control.Else
	V.Local.sTitle.Set("Sequence*!*Workcenter*!*Description")
	V.Local.sWidth.Set("1200*!*1000*!*4800")
	F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
	F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.String.Build("Select SEQ, PART, DESCRIPTION from V_JOB_OPERATIONS where JOB = '{0}' AND SUFFIX = '{1}' AND LMO = 'L' and SEQ < 995000 order by job,suffix,seq",V.Screen.FormTimesheet!txtAJob.Text,V.Screen.FormTimesheet!txtASuff.Text,V.Local.sSql)
	F.Intrinsic.UI.Browser("Select Sequence","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Local.sWC.set(V.Local.sRet(1))
		F.Intrinsic.String.Left(v.Local.sWC,4,v.Local.sWC)
		GUI.FormTimesheet.txtASeq.Text(V.Local.sRet(0))
		GUI.FormTimesheet.txtWC.Text(v.Local.sWC)
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdaddseqbrows_click.End

Program.Sub.cmdadd_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
v.Local.iCheck.Declare(Long)
v.Local.iCheck1.Declare(Long)
v.Local.iCheck2.Declare(Long)
v.Local.sWC.Declare(String)
v.Local.sJSS.Declare(String)
v.Local.sJS.Declare(String)

v.Global.bSaveMsg.Set(False)
F.Intrinsic.Control.CallSub(cmdsave_click)

v.Local.sWC.Set(V.Screen.FormTimesheet!txtWC.text)

F.Intrinsic.String.UCase(v.Local.sWC,v.Local.sWC)
F.Intrinsic.String.Build("Select count(JOB) from V_JOB_OPERATIONS WHERE JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Screen.FormTimesheet!txtAJob.Text,V.Screen.FormTimesheet!txtASuff.Text,V.Screen.FormTimesheet!txtASeq.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck1)

F.Intrinsic.String.Build("Select count(JOB) from V_JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}'",V.Screen.FormTimesheet!txtAJob.Text,V.Screen.FormTimesheet!txtASuff.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck)
F.Intrinsic.String.Build("Select count(MACHINE) from WORKCENTERS WHERE MACHINE = '{0}'",v.Local.sWC,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck2)

F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtAJob.Text.trim,=,"")
	F.Intrinsic.UI.Msgbox("No job selected or entered to save!","Add Job")
F.Intrinsic.Control.ElseIf(V.Screen.FormTimesheet!txtASeq.Text.TRIM,=,"")
	F.Intrinsic.UI.Msgbox("No sequence selected to save!","Select Sequence")
F.Intrinsic.Control.ElseIf(V.Global.sUser.Trim,=,"")
	F.Intrinsic.UI.Msgbox("No Employee Selected!","Select Employee")
F.Intrinsic.Control.ElseIf(v.Local.iCheck,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Job and Suffix entered!","Incorrect Job or Suffix")
F.Intrinsic.Control.ElseIf(v.Local.iCheck1,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Sequence entered!","Incorrect Sequence")
F.Intrinsic.Control.ElseIf(v.Local.iCheck2,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Work Center entered!","Incorrect Work Center")
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Select * from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,V.Screen.FormTimesheet!txtAJob.Text,V.Screen.FormTimesheet!txtASuff.Text,V.Screen.FormTimesheet!txtASeq.Text,V.Global.dDate.PervasiveDate,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)
	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
		F.ODBC.con!rst.AddNew
		F.ODBC.con!rst.Set!USER_ID(V.Global.sUser)
		F.ODBC.con!rst.Set!JOB(V.Screen.FormTimesheet!txtAJob.Text)
		F.ODBC.con!rst.Set!SUFFIX(V.Screen.FormTimesheet!txtASuff.Text)
		F.ODBC.con!rst.Set!SEQ(V.Screen.FormTimesheet!txtASeq.Text)
		F.ODBC.con!rst.Set!WC(v.Local.sWC)
		F.ODBC.con!rst.Set!BEG_WEEK(V.Global.dDate.PervasiveDate)
		F.ODBC.con!rst.Set!SUN_HRS(0)
		F.ODBC.con!rst.Set!SUN_NOTES("")
		F.ODBC.con!rst.Set!MON_HRS(0)
		F.ODBC.con!rst.Set!MON_NOTES("")
		F.ODBC.con!rst.Set!TUES_HRS(0)
		F.ODBC.con!rst.Set!TUES_NOTES("")
		F.ODBC.con!rst.Set!WED_HRS(0)
		F.ODBC.con!rst.Set!WED_NOTES("")
		F.ODBC.con!rst.Set!THUR_HRS(0)
		F.ODBC.con!rst.Set!THUR_NOTES("")
		F.ODBC.con!rst.Set!FRI_HRS(0)
		F.ODBC.con!rst.Set!FRI_NOTES("")
		F.ODBC.con!rst.Set!SAT_HRS(0)
		F.ODBC.con!rst.Set!SAT_NOTES("")
		F.ODBC.con!rst.Set!UPDATED(0)
		F.ODBC.con!rst.Set!Flag_Ready(0)
		F.ODBC.con!rst.Set!JOB_NOTES(v.Screen.F_newNotes!txtNewNotes.Text)
		F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,v.Local.sJSS)
		F.intrinsic.String.Concat(V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,v.Local.sJS)
		F.Data.DataTable.AddRow("dtTimesheet","JSS",v.Local.sJSS,"JS",v.Local.sJS,"Job",V.ODBC.con!rst.FieldValTrim!JOB,"Suffix",V.ODBC.con!rst.FieldValTrim!SUFFIX,"SEQ",V.ODBC.con!rst.FieldValTrim!SEQ,"WC",V.ODBC.con!rst.FieldValTrim!WC,"SUN_HRS",V.ODBC.con!rst.FieldVal!SUN_HRS,"MON_HRS",V.ODBC.con!rst.FieldVal!MON_HRS,"TUES_HRS",V.ODBC.con!rst.FieldVal!TUES_HRS,"WED_HRS",V.ODBC.con!rst.FieldVal!WED_HRS,"THUR_HRS",V.ODBC.con!rst.FieldVal!THUR_HRS,"FRI_HRS",V.ODBC.con!rst.FieldVal!FRI_HRS,"SAT_HRS",V.ODBC.con!rst.FieldVal!SAT_HRS,"UPDATED",V.ODBC.con!rst.FieldVal!UPDATED,"FLAG_READY",V.ODBC.con!rst.FieldVal!FLAG_READY,"Wrapper","A", "JOB_NOTES", V.ODBC.con!rst.FieldVal!JOB_NOTES)
		F.Data.Datatable.FillFromDictionary("dtTimesheet","DescDict","JS","Description")
		F.Data.Datatable.FillFromDictionary("dtTimesheet","FGDict","JS","Part")
		F.Data.Datatable.FillFromDictionary("dtTimesheet","dictSeqDesc", "JSS", "SEQ_DESCRIPTION")
		F.ODBC.con!rst.Update
		F.ODBC.con!rst.Close
		GUI.FormTimesheet.txtAJob.Text("")
		GUI.FormTimesheet.txtASuff.Text("")
		GUI.FormTimesheet.txtASeq.Text("")
		GUI.FormTimesheet.txtWC.Text("")
		gui.F_newNotes.txtNewNotes.Text("")
	F.Intrinsic.Control.Else
		F.ODBC.con!rst.Close
		F.Intrinsic.UI.Msgbox("Job sequence already exists on timesheet!","Save Error")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdadd_click.End

Program.Sub.cmdtemp_click.Start
F.Intrinsic.Control.Try

GUI.FormTimesheet..Enabled(False)
F.Intrinsic.Control.CallSub(Templist)
GUI.F_Template..Show

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtemp_click.End

Program.Sub.TempList.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sKey.Declare(String)

'Loads Template listview with the template data found in ATG_TIMSHEET_TEMP
GUI.F_Template.lvwTemp.ClearItems
F.Intrinsic.String.Build("Select * from GCG_6574_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' ORDER BY JOB,SUFFIX,SEQ",V.Global.sUser,V.Local.sSql)
F.ODBC.Connection!con.OpenRecordsetRO("rst",V.Local.sSql)

F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,True)
	F.Intrinsic.String.Build("{0}*!*{1}*!*{2}",V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sKey)
	GUI.F_Template.lvwTemp.AddListItem(V.Local.sKey,V.ODBC.con!rst.FieldValTrim!JOB)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,1,V.ODBC.con!rst.FieldValTrim!SUFFIX)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,2,V.ODBC.con!rst.FieldValTrim!SEQ)
	GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,3,V.ODBC.con!rst.FieldValTrim!WC)
	F.Intrinsic.String.Build("Select DESCRIPTION from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.ODBC.con!rst.FieldValTrim!JOB,V.ODBC.con!rst.FieldValTrim!SUFFIX,V.ODBC.con!rst.FieldValTrim!SEQ,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRO("rstDesc",V.Local.sSql)

	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,<>,True)
		GUI.F_Template.lvwTemp.SetListItemSubItemText(V.Local.sKey,4,V.ODBC.con!rstDesc.FieldValTrim!DESCRIPTION)
	F.Intrinsic.Control.EndIf

	F.ODBC.con!rstDesc.Close
	F.ODBC.con!rst.MoveNext
F.Intrinsic.Control.Loop

F.ODBC.con!rst.Close

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.TempList.End

Program.Sub.f_template_unload.Start
F.Intrinsic.Control.Try

GUI.F_Template..Visible(False)
GUI.F_Template.txtTmpJob.Text("")
GUI.F_Template.txtTmpSeq.Text("")
GUI.F_Template.txtTmpSuff.Text("")
GUI.FormTimesheet..Enabled(True)
GUI.FormTimesheet..setfocus

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.f_template_unload.End

Program.Sub.cmdtmpjobbrows_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sTitle.Set("Job*!*Suffix*!*Part*!*Description")
V.Local.sWidth.Set("1200*!*700*!*2200*!*2700")
V.Local.sSql.Set("Select JOB, SUFFIX, PART, DESCRIPTION from V_JOB_HEADER ORDER BY JOB, SUFFIX")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select Job","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.F_Template.txtTmpJob.Text(V.Local.sRet(0))
	GUI.F_Template.txtTmpSuff.Text(V.Local.sRet(1))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpjobbrows_click.End

Program.Sub.cmdAddWC_Click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sTitle.Set("Work Center*!*WC Name*!*WC Dept")
V.Local.sWidth.Set("1200*!*2700*!*1200")
V.Local.sSql.Set("Select MACHINE, WC_DEPT, WC_NAME from WORKCENTERS ORDER BY MACHINE, WC_DEPT")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select WorkCenter","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.FormTimesheet.txtWC.Text(V.Local.sRet(0))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdAddWC_Click.End

Program.Sub.cmdTmpAddWC_Click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sTitle.Set("Work Center*!*WC Name*!*WC Dept")
V.Local.sWidth.Set("1200*!*2700*!*1200")
V.Local.sSql.Set("Select MACHINE, WC_DEPT, WC_NAME from WORKCENTERS ORDER BY MACHINE, WC_DEPT")

F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select WorkCenter","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	GUI.F_Template.txtTmpWC.Text(V.Local.sRet(0))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdTmpAddWC_Click.End

Program.Sub.cmdtmpseqbrows_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sTitle.Declare(String)
V.Local.sWidth.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sWC.Declare(String)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpJob.Text,=,"")
	F.Intrinsic.UI.Msgbox("No job selected!","Select Job")
F.Intrinsic.Control.Else
	V.Local.sTitle.Set("Sequence*!*Workcenter*!*Description")
	V.Local.sWidth.Set("1200*!*1000*!*4800")
	
	F.Intrinsic.String.Split(V.Local.sTitle,"*!*",V.Local.sTitle)
	F.Intrinsic.String.Split(V.Local.sWidth,"*!*",V.Local.sWidth)

	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.String.Build("Select SEQ, PART, DESCRIPTION from V_JOB_OPERATIONS where JOB = '{0}' AND SUFFIX = '{1}' AND LMO = 'L' and SEQ < 995000 ORDER BY Job,Suffix,SEQ",V.Screen.F_Template!txtTmpJob.Text,V.Screen.F_Template!txtTmpSuff.Text,V.Local.sSql)
	F.Intrinsic.UI.Browser("Select Sequence","con",V.Local.sSql,V.Local.sTitle,V.Local.sWidth,8000,8000,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Local.sWC.set(V.Local.sRet(1))
		F.Intrinsic.String.Left(v.Local.sWC,4,v.Local.sWC)
		GUI.F_Template.txtTmpSeq.Text(V.Local.sRet(0))
		GUI.F_Template.txtTmpWC.Text(v.Local.sWC)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpseqbrows_click.End

Program.Sub.cmdtmpadd_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
v.Local.iCheck.Declare(Long)
v.Local.iCheck1.Declare(Long)
v.Local.iCheck2.Declare(Long)
v.Local.sWC.Declare(String)

v.Global.bSaveMsg.Set(False)

v.Local.sWC.Set(V.Screen.F_Template!txtTmpWC.text)

F.Intrinsic.String.UCase(v.Local.sWC,v.Local.sWC)
F.Intrinsic.String.Build("Select count(JOB) from V_JOB_OPERATIONS WHERE JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Screen.F_Template!txtTmpJob.text,V.Screen.F_Template!txtTmpSuff.text,V.Screen.F_Template!txtTmpSeq.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck1)

F.Intrinsic.String.Build("Select count(JOB) from V_JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}'",V.Screen.F_Template!txtTmpJob.Text,V.Screen.F_Template!txtTmpSuff.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck)
F.Intrinsic.String.Build("Select count(MACHINE) from WORKCENTERS WHERE MACHINE = '{0}'",v.Local.sWC,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql,V.Local.iCheck2)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpJob.Text,=,"")
	F.Intrinsic.UI.Msgbox("No job selected to save!","Save Job")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpSeq.Text,=,"")
	F.Intrinsic.UI.Msgbox("No sequence selected to save!","Save Sequence")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpWC.Text,=,"")	
	F.Intrinsic.UI.Msgbox("No Workcenter selected to save!","Save Work Center")
F.Intrinsic.Control.ElseIf(v.Local.iCheck,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Job and Suffix entered!","Incorrect Job or Suffix")
F.Intrinsic.Control.ElseIf(v.Local.iCheck1,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Sequence entered!","Incorrect Sequence")
F.Intrinsic.Control.ElseIf(v.Local.iCheck2,=,0)
	F.Intrinsic.UI.Msgbox("Invalid Work Center entered!","Incorrect Work Center")
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Select * from GCG_6574_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}'",V.Global.sUser,V.Screen.F_Template!txtTmpJob.Text,V.Screen.F_Template!txtTmpSuff.Text,V.Screen.F_Template!txtTmpSeq.Text,V.Local.sSql)
	F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)

	F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
		F.ODBC.con!rst.AddNew
		F.ODBC.con!rst.Set!USER_ID(V.Global.sUser)
		F.ODBC.con!rst.Set!JOB(V.Screen.F_Template!txtTmpJob.Text)
		F.ODBC.con!rst.Set!SUFFIX(V.Screen.F_Template!txtTmpSuff.Text)
		F.ODBC.con!rst.Set!SEQ(V.Screen.F_Template!txtTmpSeq.Text)
		F.ODBC.con!rst.Set!WC(V.Screen.F_Template!txtTmpWC.Text)
		F.ODBC.con!rst.Update
		GUI.F_Template.txtTmpJob.Text("")
		GUI.F_Template.txtTmpSuff.Text("")
		GUI.F_Template.txtTmpSeq.Text("")
		GUI.F_Template.txtTmpWC.Text("")
		F.ODBC.con!rst.Close
		F.Intrinsic.Control.CallSub(Templist)
	F.Intrinsic.Control.Else
		F.ODBC.con!rst.Close
		F.Intrinsic.UI.Msgbox("Job sequence already exists on template!","Sequence Exists")
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpadd_click.End

Program.Sub.cmdtmpdelete_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.Control.If(V.Screen.F_Template!txtTmpJob.Text,=,"")
	F.Intrinsic.UI.Msgbox("No job selected to delete!","Delete Job")
F.Intrinsic.Control.ElseIf(V.Screen.F_Template!txtTmpSeq.Text,=,"")
	F.Intrinsic.UI.Msgbox("No sequence selected to delete!","Delete Sequence")
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Are you sure you want to delete this record from template?","Delete Record",4,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,=,"6")
		F.Intrinsic.String.Build("Delete from GCG_6574_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}'",v.Global.sUser,V.Screen.F_Template!txtTmpJob.Text,V.Screen.F_Template!txtTmpSuff.Text,V.Screen.F_Template!txtTmpSeq.Text,V.Local.sSql)
		F.ODBC.Connection!con.Execute(V.Local.sSql)
		GUI.F_Template.txtTmpJob.Text("")
		GUI.F_Template.txtTmpSuff.Text("")
		GUI.F_Template.txtTmpSeq.Text("")
		F.Intrinsic.Control.CallSub(Templist)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpdelete_click.End

Program.Sub.cmdtmpdeleteall_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.UI.Msgbox("This will delete your entire template, are you sure?","Delete Template",4,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,=,"6")
	F.Intrinsic.String.Build("Delete GCG_6574_TIMSHT_TEMP where UPPER(USER_ID) = '{0}'",V.Global.sUser,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
	GUI.F_Template.txtTmpJob.Text("")
	GUI.F_Template.txtTmpSuff.Text("")
	GUI.F_Template.txtTmpSeq.Text("")
	F.Intrinsic.Control.CallSub(Templist)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdtmpdeleteall_click.End

Program.Sub.lvwtemp_itemclick.Start
F.Intrinsic.Control.Try

V.Local.sRet.Declare(String)

'Template Entries Screen, this sets the values of the textboxes to the values you selected in the grid
F.Intrinsic.String.Split(V.Screen.F_Template!lvwTemp.SelectedItemKey,"*!*",V.Local.sRet)
GUI.F_Template.txtTmpJob.Text(V.Local.sRet(0))
GUI.F_Template.txtTmpSuff.Text(V.Local.sRet(1))
GUI.F_Template.txtTmpSeq.Text(V.Local.sRet(2))

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.lvwtemp_itemclick.End

Program.Sub.cmdsave_click.Start
F.Intrinsic.Control.Try

V.Local.i.Declare(Long)
V.Local.sSql.Declare(String)
V.Local.iRow.Declare(Long)
V.Local.sRow.Declare(String)
V.Local.sRowArray.Declare(String)
V.Local.sMap.Declare(String)
v.Local.sName.Declare

F.Data.DataView.ToDataTable("dtTimesheet","dvTimesheet","SavinDT")

F.Data.DataView.Create("SavinDT","SaveVw",22,"UPDATED = 0","")

F.Data.DataView.ToDataTable("SavinDT","SaveVw","SaveDT")

F.Data.DataTable.AddColumn("SaveDT","USER_ID","STRING")
F.Data.DataTable.SetValue("SaveDT",-1,"USER_ID",V.Global.sUser)

F.Data.DataTable.AddColumn("SaveDT","BEG_WEEK","STRING")
F.Data.DataTable.SetValue("SaveDT",-1,"BEG_WEEK",V.Global.dDate.PervasiveDate)

'Get Name
F.Data.DataTable.AddColumn("SaveDT","USER_NAME","STRING")
'f.ODBC.Connection!common.OpenCommonConnection
 	f.Intrinsic.String.Build("Select top 1 NAME from V_EMPLOYEE_MSTR where PR_USER_ID = '{0}'", v.Global.sUser, v.Local.sSql)
 	f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSql, v.Local.sName)
'f.ODBC.Connection!common.Close
F.Data.DataTable.SetValue("SaveDT",-1,"USER_NAME", V.Local.sName)
f.Data.Datatable.AcceptChanges("SaveDT")

v.Local.sMap.set("USER_ID@!@USER_ID*!*JOB@!@JOB*!*SUFFIX@!@SUFFIX*!*SEQ@!@SEQ*!*BEG_WEEK@!@BEG_WEEK*!*WC@!@WC*!*SUN_HRS@!@SUN_HRS*!*MON_HRS@!@MON_HRS*!*TUES_HRS@!@TUES_HRS*!*WED_HRS@!@WED_HRS*!*THUR_HRS@!@THUR_HRS*!*FRI_HRS@!@FRI_HRS*!*SAT_HRS@!@SAT_HRS*!*UPDATED@!@UPDATED*!*FLAG_READY@!@FLAG_READY*!*SUN_NOTES@!@SUN_NOTES*!*MON_NOTES@!@MON_NOTES*!*TUES_NOTES@!@TUES_NOTES*!*WED_NOTES@!@WED_NOTES*!*THUR_NOTES@!@THUR_NOTES*!*FRI_NOTES@!@FRI_NOTES*!*SAT_NOTES@!@SAT_NOTES*!*JOB_NOTES@!@JOB_NOTES*!*USER_NAME@!@USER_NAME")
Function.Data.DataTable.SaveToDB("SaveDT","con","GCG_6574_TIMSHT","USER_ID*!*JOB*!*SUFFIX*!*SEQ*!*BEG_WEEK",256,v.Local.sMap)

F.Data.DataTable.Close("SaveDT")
F.Data.DataTable.Close("SavinDT")

F.Intrinsic.Control.If(v.Global.bSaveMsg,=,true)
	F.Intrinsic.UI.Msgbox("All records saved!","Save Records")
	v.Global.bSaveMsg.Set(false)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(ComputeTotals)

v.Global.bSaveMsg.Set(false)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdsave_click.End

Program.Sub.cmdupdate_click.Start
F.Intrinsic.Control.Try

V.Local.sSql.Declare(String)
V.Local.iRet.Declare(Long)
V.Local.sEmp.Declare(String)
V.Local.sDay.Declare(String)
V.Local.sFile.Declare(String)
V.Local.sExecute.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sQuery.Declare(String)
'update to the update.
'We now have a new checkbox that has the option to update ALL employees whose times are ready Flag_Ready for the selected Week.
'the quote says jack about showing all employees within the grid when they want to do a global update. so being the good guy I'm going to wrn them say hay... this will
'update all employees that are ready. Since you have that checked.
F.Intrinsic.Control.If(V.Global.iRun,<,1)
	F.Intrinsic.Math.Add(V.Global.iRun,1,V.Global.iRun)
	GUI.FormTimesheet.dtpWeek.Enabled(False)
	F.Intrinsic.Control.If(V.Global.bAdminMode,=,True,"AND",V.Screen.FormTimesheet!chkAllEmployees.Value,=,1)
		F.Intrinsic.UI.Msgbox("Are you sure you want to post this week's hours to Global Shop for ALL EMPLOYEES whose records are marked as READY?","Update Records",4,V.Local.iRet)
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("Are you sure you want to post this week's hours to Global Shop?","Update Records",4,V.Local.iRet)
	F.Intrinsic.Control.EndIf
	V.Global.iChk.Set(1)
	F.Intrinsic.Control.CallSub(Cmdsave_click)
	V.Global.iChk.Set(0)

	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		F.Intrinsic.Control.If(V.Screen.FormTimesheet!chkAllEmployees.Value,=,1)
			F.Intrinsic.String.Build("Select Distinct UPPER(user_ID) AS user_ID from GCG_6574_TIMSHT Where BEG_WEEK = '{0}' And Flag_Ready = '1' and Updated = '0' Order By User_ID",V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Select Distinct UPPER(USER_ID) as USER_ID from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' And Flag_ready = '1' and Updated = '0'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSql)
		F.Intrinsic.Control.EndIf

		F.ODBC.Connection!con.OpenRecordsetRW("rst",V.Local.sSql)

		F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
			F.Intrinsic.UI.Msgbox("No saved records to update!","Save Records")
		
		F.Intrinsic.Control.Else
	
	'fudge
	'we have to loop through our recordset, requery the info cause all we want is the current line, then do it all over again.
				F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,True)

					F.Intrinsic.UI.InvokeWaitDialog("Loading records to Global Shop!","Update")
					
					F.Intrinsic.String.Build("Select EMPLOYEE from V_EMPLOYEE_MSTR where PR_USER_ID = '{0}'",V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sQuery)
					F.ODBC.Connection!con.OpenLocalRecordsetRO("rstEmp",V.Local.sQuery)
					F.Intrinsic.Control.If(V.ODBC.con!rstEmp.EOF,=,False)
						V.Local.sEmp.Set(V.ODBC.con!rstEmp.FieldValTrim!Employee)
					F.Intrinsic.Control.Else
'						letthemselecttheemployee? cause it's blank. may be a setup issue, but lets handle it.
						F.Intrinsic.String.Build("Employee ID can't be found for User: {0}. Please select now.",V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sQuery)
						F.Intrinsic.UI.Msgbox(V.Local.sQuery)
						F.Intrinsic.UI.Browser(51,"",V.Local.sRet)
						F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
							F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
							V.Local.sEmp.Set(V.Local.sRet(0).Trim)
						F.Intrinsic.Control.Else
							V.Local.sEmp.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
					F.ODBC.con!rstEmp.Close

					F.Intrinsic.Control.If(V.Local.sEmp.Trim,<>,"")
						F.Intrinsic.Control.If(v.DataTable.DTtime.Exists,=,True)
							F.Data.DataTable.Close("DTtime")
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("Select * from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}' And Flag_ready = '1' and updated = '0'",V.ODBC.con!rst.FieldValTrim!USER_ID,V.Global.dDate.PervasiveDate,V.Local.sSql)
						F.Data.DataTable.CreateFromSQL("DTtime","con",v.local.sSql,true)
						F.Intrinsic.String.Build("Update GCG_6574_Timsht Set Updated = '1' Where Beg_Week = '{0}' And UPPER(USER_ID) = '{1}'",V.Global.dDate.PervasiveDate,V.ODBC.con!rst.FieldValTrim!User_ID,V.Local.sSql)
						F.ODBC.Connection!con.Execute(V.Local.sSql)
						
						V.Local.sDay.Set("Sun")
						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SUN_HRS")
								
						V.Local.sDay.Set("Mon")
						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","MON_HRS")
						
						V.Local.sDay.Set("Tues")
						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","TUES_HRS")
						
						V.Local.sDay.Set("Wed")
						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","WED_HRS")
						
						V.Local.sDay.Set("Thur")
						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","THUR_HRS")
						
						V.Local.sDay.Set("Fri")
						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","FRI_HRS")
						
						V.Local.sDay.Set("Sat")
						F.Intrinsic.Control.CallSub(Buildfile,"Day",V.Local.sDay,"Emp",V.Local.sEmp,"Col","SAT_HRS")

						F.Intrinsic.Control.CallSub(JB0455Sync)
						F.ODBC.Connection!con.Execute(V.Local.sSql)
					F.Intrinsic.Control.EndIf

					F.ODBC.con!rst.MoveNext
				F.Intrinsic.Control.Loop
				
				GUI.FormTimesheet.cmdUpdate.Enabled(False)
				GUI.FormTimesheet.gsgcTimesheet.Enabled(False)
				F.Intrinsic.UI.CloseWaitDialog

		F.Intrinsic.Control.EndIf
		F.ODBC.con!rst.close
	F.Intrinsic.Control.EndIf

	V.Global.iRun.Set(0)
	GUI.FormTimesheet.dtpWeek.Enabled(True)
F.Intrinsic.Control.EndIf

GUI.FormTimesheet..AlwaysOnTop(True)
GUI.FormTimesheet..AlwaysOnTop(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdupdate_click.End

Program.Sub.BuildFile.Start
F.Intrinsic.Control.Try

V.Local.dDate.Declare(Date)
V.Local.sDate.Declare(String)
V.Local.iDay.Declare(Long)
V.Local.sDay.Declare(String)
V.Local.sBegTime.Declare(String)
V.Local.i.Declare(Long)
V.Local.sHrs.Declare(String)
V.Local.sTime.Declare(String)
V.Local.sStart.Declare(String)
V.Local.sStop.Declare(String)
V.Local.sStartHH.Declare(String)
V.Local.sStartMM.Declare(String)
V.Local.sStopHH.Declare(String)
V.Local.sStopMM.Declare(String)
V.Local.sSql.Declare(String)
V.Local.sJob.Declare(String)
V.Local.sSuff.Declare(String)
V.Local.sSeq.Declare(String)
V.Local.sWC.Declare(String)
v.Local.fMm.Declare(Float)
V.Local.sRet.Declare(String)

F.Intrinsic.Control.If(V.Args.Day,=,"Sun")
	V.Local.dDate.Set(V.Global.dDate)
	V.Local.iDay.Set(7)
	V.Local.sDay.Set("START_SUN")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Mon")
	F.Intrinsic.Date.DateAdd("D",1,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(1)
	V.Local.sDay.Set("START_MON")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Tues")
	F.Intrinsic.Date.DateAdd("D",2,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(2)
	V.Local.sDay.Set("START_TUE")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Wed")
	F.Intrinsic.Date.DateAdd("D",3,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(3)
	V.Local.sDay.Set("START_WED")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Thur")
	F.Intrinsic.Date.DateAdd("D",4,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(4)
	V.Local.sDay.Set("START_THR")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Fri")
	F.Intrinsic.Date.DateAdd("D",5,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(5)
	V.Local.sDay.Set("START_FRI")
F.Intrinsic.Control.ElseIf(V.Args.Day,=,"Sat")
	F.Intrinsic.Date.DateAdd("D",6,V.Global.dDate,V.Local.dDate)
	V.Local.iDay.Set(6)
	V.Local.sDay.Set("START_SAT")
F.Intrinsic.Control.EndIf

'grab actual clock in time for start time
F.Intrinsic.String.Build("select RTRIM(SUBSTRING(TIME_IN, 1, 4)) from TIME_ATTENDANCE where EMPLOYEE = '{0}' and CHARGE_DATE = '{1}'", V.Args.Emp, V.Local.dDate.FormatYYYYMMDD, V.Local.sSQL)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql, V.Local.sRet)
F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.sBegTime.Set("0800")
	V.Local.sStart.Set("0800")
	V.Local.sStop.Set("0800")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Local.sRet.Trim, =, "")
		V.Local.sBegTime.Set("0800")
		V.Local.sStart.Set("0800")
		V.Local.sStop.Set("0800")
	F.Intrinsic.Control.Else
		V.Local.sBegTime.Set(V.Local.sRet)
		F.Intrinsic.Math.Div(V.Local.sRet.Right2, 0.6, V.Local.sRet)
		F.Intrinsic.String.Format(V.Local.sRet, "00", V.Local.sRet)
		F.Intrinsic.String.Build("{0}{1}", V.Local.sBegTime.Left2, V.Local.sRet, V.Local.sStart)
		V.Local.sStop.Set(V.Local.sStart)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.For(V.Local.i,0,v.DataTable.DTtime.RowCount--,1)
	F.Intrinsic.Control.If(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,<>,0)
	
		F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,"#0.0000",V.Local.sHrs)
		F.Intrinsic.String.Format(v.DataTable.DTtime(V.Local.i).[V.Args.Col]!FieldValFloat,"00.00",V.Local.sTime)
		
		V.Local.sStart.Set(V.Local.sStop)
		F.Intrinsic.String.Right(V.Local.sStart,2,V.Local.sStartMM)
		F.Intrinsic.String.Left(V.Local.sStart,2,V.Local.sStartHH)
		F.Intrinsic.String.Right(V.Local.sTime,2,V.Local.sStopMM)
		F.Intrinsic.String.Left(V.Local.sTime,2,V.Local.sStopHH)
		F.Intrinsic.Math.Add(V.Local.sStartHH,V.Local.sStopHH,V.Local.sStopHH)
		
		'at this point, stop is in decimal and start is in minutes
		F.Intrinsic.Math.Mult(V.Local.sStopMM, 0.6, V.Local.sStopMM)
		F.Intrinsic.Math.Add(V.Local.sStartMM,V.Local.sStopMM,V.Local.sStopMM)
		
		F.Intrinsic.Control.If(V.Local.sStopMM.Long, >= , 60)
			F.Intrinsic.Math.Add(V.Local.sStopHH,1,V.Local.sStopHH)
			F.Intrinsic.Math.Sub(V.Local.sStopMM,60,V.Local.sStopMM)
		F.Intrinsic.Control.EndIf

		F.Intrinsic.String.Format(V.Local.sStopHH,"00",V.Local.sStopHH)
		F.Intrinsic.String.Format(V.Local.sStopMM,"00",V.Local.sStopMM)
		F.Intrinsic.String.Build("{0}{1}",V.Local.sStopHH,V.Local.sStopMM,V.Local.sStop)

		F.Intrinsic.Control.If(V.Local.sStop,=,"2400")
			V.Local.sStop.Set("2359")
		F.Intrinsic.Control.EndIf

		V.Local.sJob.Set(v.DataTable.DTtime(V.Local.i).Job!FieldVal)
		V.Local.sSuff.Set(v.DataTable.DTtime(V.Local.i).Suffix!FieldVal)
		V.Local.sSeq.Set(v.DataTable.DTtime(V.Local.i).Seq!FieldVal)
		F.Intrinsic.String.Build("Select WORKCENTER from V_JOB_OPERATIONS_WC where JOB = '{0}' AND SUFFIX = '{1}' AND SEQ = '{2}'",V.Local.sJob,V.Local.sSuff,V.Local.sSeq,V.Local.sSql)
		F.ODBC.Connection!con.OpenLocalRecordsetRO("rstWC",V.Local.sSql)
		V.Local.sWC.Set(v.DataTable.DTtime(V.Local.i).WC!FieldVal)

		F.ODBC.con!rstWC.Close
		F.Intrinsic.String.Format(V.Local.dDate,"MMDDYY",V.Local.sDate)
		
		F.Data.DataTable.AddRow("JB0455","Date",V.Local.sDate,"Employee",V.Args.Emp,"Job",V.Local.sJob,"Suffix",V.Local.sSuff,"Seq",V.Local.sSeq,"WC",V.Local.sWC,"Closed","N","Indirect","D","StartTime",V.Local.sStart,"StopTime",V.Local.sStop,"RateType","R","GoodPcs","0","ScrapPcs","0")
	
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.BuildFile.End

Program.Sub.cmdready_click.Start
F.Intrinsic.Control.Try

V.Local.sRet.Declare(String)
V.Local.sSQL.Declare(String)
v.Local.bReady.Declare(Boolean)

F.Intrinsic.Control.If(V.Global.suSer.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(v.DataTable.dtTimesheet.RowCount,>,0,"AND",v.Global.bAdminMode,=,false)
	F.Intrinsic.Control.CallSub(MessageBox, "Title", "Flag as ready?", "Message", "Do you wish to flag the displayed time as Ready for Approval?", "YesAndNo", True)

	F.Intrinsic.Control.If(V.Global.sMessageBoxReturn.Trim, =, "YES")
		F.Intrinsic.Control.CallSub(cmdsave_click)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Update GCG_6574_TIMSHT Set FLAG_READY = '1' Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
F.ODBC.Connection!con.Execute(V.Local.sSQL)

F.Data.DataTable.SetValue("dtTimesheet",-1,"Flag_ready",true)

F.Intrinsic.String.Build("Records with date {0} and User {1} have been marked as Ready.",V.Global.dDate,V.Global.sUser,V.Local.sSQL)
F.Intrinsic.Control.CallSub(MessageBox, "Title", "", "Message", V.Local.sSQL, "YesAndNo", False)

GUI.FormTimesheet.cmdReady.Enabled(False)
GUI.FormTimesheet.cmdUpdate.Enabled(true)
F.Intrinsic.Control.If(V.Global.bAdminMode,=,False)
	'disable save
	GUI.FormTimesheet.cmdSave.Enabled(False)
	GUI.FormTimesheet.cmdAdd.Enabled(False)
	GUI.FormTimesheet.cmdFrmTemp.Enabled(False)
	
	'disable the add button cause when they can adda a new job it some how re enables the save.
	GUI.FormTimesheet.cmdAdd.Enabled(False)

	'rintGushee
	GUI.FormTimesheet.cmdPrint.Enabled(True)
	
	'flexgridGUI.F_Ti
	GUI.FormTimesheet.gsgcTimesheet.Enabled(False)

F.Intrinsic.Control.Else
	GUI.FormTimesheet.cmdUnlock.Enabled(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdready_click.End

Program.Sub.cmdprint_click.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
V.Local.iRPTID.Declare(Long)
V.Local.sParam.Declare(String)
V.Local.sVals.Declare(String)
V.Local.sRet.Declare(String)

V.Local.sParam.Set("START_DATE*!*BIRUNID*!*GUI_HOURS*!*BALANCE_HOURS*!*HOURS_TA")

F.Intrinsic.UI.InvokeWaitDialog("Printing Report...")

F.global.BI.GetIDFromName("GCG_6574_TimeSheet.rpt",V.Local.iRPTID)

F.Intrinsic.Control.If(V.Local.iRPTID,=,-1)
	F.Intrinsic.UI.CloseWaitDialog
	F.Intrinsic.UI.Msgbox("GCG_6574_Timesheet.rpt not found as an active report. Please Activate within Report Maintenance")

	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.BlockEvents

F.Global.BI.GetRunID(V.Global.iBIRUNID)
F.Global.BI.StartLogging(V.Global.iBIRUNID,V.Local.iRptID,-1,"",V.Global.iLogID)
F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!*{3}*!*{4}",V.Global.dDate.formatYYYYMMDD,V.Global.iBIRUNID, V.Screen.FormTimesheet!txtGUIHours.Text.Trim, V.Screen.FormTimesheet!txtHoursBalance.Text.Trim, V.Screen.FormTimesheet!txtHoursTA.Text.Trim, V.Local.sVals)

'ask user in admin mode if they want to print all ready recrods for all employees or just employee selected.
F.Intrinsic.Control.If(V.Global.bAdminMode,=,True)
	'Print Records for all or just selected.")
	F.Intrinsic.UI.Msgbox("Print ready time for ALL employees?","All Employees?",4,V.Local.sRet)
F.Intrinsic.Control.EndIf

'so we have to figure out if it's for all users or employee selected.
'we can only print the users ready time

F.Intrinsic.Control.If(V.Local.sRet,=,6)
	'tey want all users.
	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.Job,GCG.Suffix,GCG.Seq as SEQUENCE,JO.Description,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS, JOB_NOTES from GCG_6574_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Left Join V_Job_Operations AS JO On GCG.Job = JO.Job And GCG.Suffix = JO.Suffix and GCG.Seq = JO.SEQ Where Flag_Ready = '1' And BEG_WEEK = '{0}' ",V.Global.dDate.Pervasivedate,V.Local.sSQL)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("select UPPER(USER_ID) AS USER_ID,E.Employee,E.Name,GCG.Job,GCG.Suffix,GCG.Seq as SEQUENCE,JO.Description,WC,Sun_HRS,Mon_HRS,Tues_HRS,WED_HRS,THUR_HRS, FRI_HRS,SAT_HRS, JOB_NOTES from GCG_6574_TIMSHT As GCG Left Join V_Employee_Mstr As E On GCG.USER_ID = E.PR_USER_ID Left Join V_Job_Operations AS JO On GCG.Job = JO.Job And GCG.Suffix = JO.Suffix and GCG.Seq = JO.SEQ Where GCG.USER_ID ='{0}' And BEG_WEEK = '{1}' ",V.Global.sUser,V.Global.dDate.Pervasivedate,V.Local.sSQL)
F.Intrinsic.Control.EndIf

F.Data.DataTable.CreateFromSQL("DTGetData","con",v.Local.sSQL)
F.Intrinsic.Control.if(v.DataTable.DTGetData.RowCount,=,0)
	F.Intrinsic.UI.Msgbox("There are no records made ready for printing.")
	F.Data.DataTable.Close("DTGetData")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.UI.CloseWaitDialog
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Select * from GCG_6574_TIMESHT_BI where BIRUNID = '{0}'",V.Global.iBIRUNID,v.Local.sSQL)
	F.data.DataTable.CreateFromSQL("DTBiUpload","con",v.Local.sSQL)
	F.Data.DataTable.RemoveColumn("DTGetData","USER_ID")
	F.Data.DataTable.AddColumn("DTGetData","BIRUNID","Long")
	F.Data.DataTable.SetValue("DTGetData",-1,"BIRUNID",V.Global.iBIRUNID)
	F.Data.datatable.Merge("DTGetData","DTBiUpload",false,2)
	F.Data.DataTable.Close("DTGetData")

	F.Intrinsic.Control.If(V.DataTable.DTBiUpload.RowCount,>,0)
		F.ODBC.Connection!con.Execute("Delete From GCG_6574_TIMESHT_BI")
		F.Data.DataTable.SaveToDB("DTBiUpload","con","GCG_6574_TIMESHT_BI","BIRUNID",128)
		F.Data.DataTable.Close("DTBiUpload")
	
		F.Global.BI.RunReportPreProcessor(V.Global.iBIRUNID,V.Global.iLogID,V.Local.sParam,V.Local.sVals,"",-1,False,"",-1,"",-1,"","",V.Global.iBIRUNID)

	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.endif

F.Intrinsic.UI.CloseWaitDialog

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdprint_click.End

Program.Sub.Admin_Mode.Start
F.Intrinsic.Control.Try

v.Local.iRet.Declare

'Are we Admin or not?
'We are looking for Group PYRLADMN
F.Intrinsic.Control.If(v.Global.sUser.Trim,=,"")
	v.Global.sUser.Set(v.Caller.User)
	F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
F.Intrinsic.Control.EndIf

F.Global.Security.IsInGroup(v.Global.sUser,"PYRLADMN",V.Caller.CompanyCode,V.Global.bAdminMode)

F.Intrinsic.Control.If(V.Global.bAdminMode)
	F.Intrinsic.UI.Msgbox("Your User ID has been flagged as an Admin for this Dashboard. Do you want to continue as an Admin or Launch the dashboard as a user to update your personal time sheet? Click 'Yes' to Launch as Admin or 'No' to Launch as a User.","Launch in Admin Mode?",4,v.Local.iRet)
	F.Intrinsic.Control.If(v.Local.iRet,=,7)
		v.Global.bAdminMode.Set(False)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'If we admin we have to Remove the Template buton and shiFt the ready and print buttons
F.Intrinsic.Control.If(V.Global.bAdminMode)
	GUI.FormTimesheet.cmdTemp.Visible(True)
	GUI.FormTimesheet.chkAllEmployees.Position(8190,9795)
	GUI.FormTimesheet.cmdTemp.Position(6990,9720)
	GUI.FormTimesheet.cmdUpdate.Position(2990,9720)
	GUI.FormTimesheet.cmdUnlock.Position(4980,9720)
 	GUI.FormTimesheet.cmdPrint.Position(5990,9720)
 	GUI.FormTimesheet.cmdReady.position(1095,9720)
	'unhide the employee search options and the unlock button
	GUI.FormTimesheet.lblEmp.Visible(True)
	GUI.FormTimesheet.txtEmployee.Visible(True)
	GUI.FormTimesheet.txtEmployee.Enabled(True)
	GUI.FormTimesheet.cmdEmpBrws.Visible(True)
	GUI.FormTimesheet.cmdEmpBrws.Enabled(True)
	GUI.FormTimesheet.cmdEmpSearch.Visible(True)
	GUI.FormTimesheet.cmdEmpSearch.Enabled(True)
	GUI.FormTimesheet.cmdUnlock.Visible(True)
	GUI.FormTimesheet.cmdPrint.Enabled(True)
	GUI.FormTimesheet.lblUser.Visible(True)
	GUI.FormTimesheet.txtUser.Visible(True)
	GUI.FormTimesheet.txtUser.Enabled(True)
	GUI.FormTimesheet.chkAllEmployees.Visible(True)
	'V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
	GUI.FormTimesheet..Caption("Timesheet Entry (Admin Mode)")
F.Intrinsic.Control.Else
	'if we aint admins, we need to remove the update button and shift temp ready and print buttons
	GUI.FormTimesheet.cmdUpdate.Visible(False)
	GUI.FormTimesheet.cmdUpdate.Position(5080,9720)
	GUI.FormTimesheet.cmdTemp.Position(1100,9720)
	GUI.FormTimesheet.cmdReady.Position(2200,9720)
	GUI.FormTimesheet.cmdPrint.Position(4050,9720)
F.Intrinsic.Control.EndIf

GUI.FormTimesheet.txtUser.Text(v.Global.sUser)
F.Intrinsic.Control.CallSub(txtUser_LostFocus)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.Admin_Mode.End

Program.Sub.cmdempbrws_click.Start
F.Intrinsic.Control.Try

V.Local.sTitle.Declare(String)
V.Local.iWidth.Declare(Long)
V.Local.sRet.Declare(String)

F.Intrinsic.String.Split("Employee*!*Name*!*GS User ID","*!*",V.Local.sTitle)
F.Intrinsic.String.Split("3500*!*3500*!*0","*!*",V.Local.iWidth)
F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select an Employee","con","Select Employee,Name,PR_USER_ID FROM V_EMPLOYEE_MSTR",V.Local.sTitle,V.Local.iWidth,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
	
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	F.Intrinsic.Control.If(V.Local.sRet(0).Trim,<>,V.Screen.FormTimesheet!txtEmployee.Text)
		
		GUI.FormTimesheet.txtEmployee.Text(V.Local.sRet(0).Trim)
		V.Global.sUser.Set(V.Local.sRet(2).Trim)
		F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
		GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
		F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
	'		Askthemfortheuser.
			F.Intrinsic.UI.Browser(10,"",V.Local.sRet)
			F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"***CANCEL***")
				F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
				V.Global.sUser.Set(V.Local.sret(1).Trim)
				F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
				GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdempbrws_click.End

Program.Sub.cmdempsearch_click.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
V.Local.sUser.Declare(String)
V.Local.sRet.Declare(String)
V.Local.sEmployee.Declare(String)

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtEmployee.Text,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.BlockEvents

F.Intrinsic.Control.CallSub(EmptyTotals)
F.Intrinsic.Control.CallSub(Gridload)
F.Intrinsic.Control.CallSub(GridTitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdempsearch_click.End

Program.Sub.cmdunlock_click.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
v.Local.iCount.Declare

F.Intrinsic.Control.If(V.Global.suSer.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Count(UPDATED) from GCG_6574_TIMSHT Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}' and UPDATED = 1",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
F.ODBC.Connection!con.executeandreturn(v.Local.sSQL,v.Local.iCount)
F.Intrinsic.Control.If(v.Local.iCount,>,0)
	F.Intrinsic.Control.CallSub(MessageBox, "Title", "", "Message", "Records have already been posted to GSS and cannot be unlocked.", "YesAndNo", False)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Update GCG_6574_TIMSHT Set FLAG_READY = '0' Where UPPER(USER_ID) = '{0}' And Beg_Week = '{1}'",V.Global.sUser,V.Global.dDate.PervasiveDate,V.Local.sSQL)
F.ODBC.Connection!con.Execute(V.Local.sSQL)

F.Intrinsic.UI.Msgbox("Records have been Unlocked...")

F.Intrinsic.Control.CallSub(cmdRefresh_Click)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdunlock_click.End

Program.Sub.gsgcTimesheet_RowCellClick.Start
F.Intrinsic.Control.Try

v.Local.ssql.Declare(string)
v.Local.sParam.Declare(string)
v.Local.sJob.Declare(string)
v.Local.sSuffix.Declare(string)
v.Local.sNotes.Declare

F.Intrinsic.Control.If(v.Args.Column,=,"Delete")
	F.Intrinsic.String.Build("DELETE from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND JOB = '{1}' AND SUFFIX = '{2}' AND SEQ = '{3}' AND BEG_WEEK = '{4}'",V.Global.sUser,v.DataTable.dtTimesheet(v.Args.RowHandle).JOB!FieldVal,v.DataTable.dtTimesheet(v.Args.RowHandle).SUFFIX!FieldVal,v.DataTable.dtTimesheet(v.Args.RowHandle).SEQ!FieldVal,V.Global.dDate.PervasiveDate,V.Local.sSql)	
	F.odbc.Connection!con.execute(v.Local.ssql)
	F.data.DataTable.DeleteRow("dtTimesheet",v.Args.RowHandle)	
	F.Intrinsic.Control.CallSub(ComputeTotals)
F.Intrinsic.Control.ElseIf(v.Args.Column.UCase,=,"JOB","OR",v.Args.Column.UCase,=,"SUFFIX",v.Args.Column.UCase,=,"SEQ", v.Args.Column.UCase,=,"JSS")
	v.Local.sJob.Set(v.DataTable.dtTimesheet(v.Args.RowHandle).JOB!FieldVal)
	v.Local.sSuffix.Set(v.DataTable.dtTimesheet(v.Args.RowHandle).SUFFIX!FieldVal)
	GUI.FormTimesheet..Enabled(False)
	F.Intrinsic.String.RPad(v.Local.sJob," ",6,v.Local.sJob)
	F.Intrinsic.String.RPad(v.Local.sSuffix," ",3,v.Local.sSuffix)

	F.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A",v.Local.sJob,v.Local.sSuffix,v.Local.sParam)

	F.Global.General.CallWrapperSync(450000,v.Local.sParam)
	GUI.FormTimesheet..SetFocus
	GUI.FormTimesheet..Enabled(True)
F.Intrinsic.Control.ElseIf(v.Args.Column.UCase, =, "JOB_NOTES")
	v.Global.iRowId.Set(v.Args.RowIndex)
	gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "JOB_NOTES", v.Args.RowIndex, v.Local.sJob)
	gui.F_New_Line.txt1.Text(v.Local.sJob)
	f.Intrinsic.Control.CallSub(chk1_Change)
	gui.F_New_Line..Visible(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.gsgcTimesheet_RowCellClick.End

Program.Sub.txtEmployee_Change.Start
F.Intrinsic.Control.Try

V.Local.sEmployee.Declare(string)
V.Local.iCheck.Declare(Long)
v.Local.sSql.Declare(String)
v.Local.sRet.Declare(String)
v.Local.sRet1.Declare(String)
V.Local.sEmployee.set(V.Screen.FormTimesheet!txtEmployee.Text)
F.Intrinsic.Control.If(v.Local.sEmployee.trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Employee,PR_USER_ID FROM V_EMPLOYEE_MSTR where employee = '{0}'",v.Local.sEmployee,v.Local.sSql)
F.odbc.Connection!con.ExecuteAndReturn(v.Local.sSql,v.Local.sRet)
F.Intrinsic.Control.BlockEvents
F.Intrinsic.Control.If(v.Local.sRet.Trim,=,"")
	F.Intrinsic.UI.Msgbox("The employee ID does not exist in the database.")
	GUI.FormTimesheet.txtUser.Text("")
	GUI.FormTimesheet.txtEmployee.Text("")
	F.Intrinsic.Control.UnBlockEvents
	GUI.FormTimesheet.txtEmployee.SetFocus
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(v.Local.sRet,"*!*",v.Local.sRet)

V.Global.sUser.Set(V.Local.sRet(1).Trim)
F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
'		Askthemfortheuser.
	F.Intrinsic.UI.Browser(10,"",V.Local.sRet1)
	F.Intrinsic.Control.If(V.Local.sRet1.Trim,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet1,"*!*",V.Local.sRet1)
		V.Global.sUser.Set(V.Local.sRet1(1).Trim)
		F.Intrinsic.String.Format(V.Global.sUser,">",V.Global.sUser)
		GUI.FormTimesheet.txtUser.Text(V.Global.sUser.Trim)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
GUI.FormTimesheet.txtUser.SetFocus
F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.txtEmployee_Change.End

Program.Sub.gsgcTimesheet_CellValueChanged.Start
F.Intrinsic.Control.Try

V.Local.bInString.Declare(Boolean)
V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sTime.Declare(String)
V.Local.sSplit.Declare(String)
V.Local.sWriteColumn.Declare(String)
V.Local.fFullDecimal.Declare(Float)
V.Local.sHours.Declare(String)
V.Local.sMinutes.Declare(String)

'get which column to modify
F.Data.Dictionary.Create("dictColumns")
F.Data.Dictionary.AddItem("dictColumns", "SUNDAY_HOURS_EDIT", "SUN_HRS")
F.Data.Dictionary.AddItem("dictColumns", "MONDAY_HOURS_EDIT", "MON_HRS")
F.Data.Dictionary.AddItem("dictColumns", "TUESDAY_HOURS_EDIT", "TUES_HRS")
F.Data.Dictionary.AddItem("dictColumns", "WEDNESDAY_HOURS_EDIT", "WED_HRS")
F.Data.Dictionary.AddItem("dictColumns", "THURSDAY_HOURS_EDIT", "THUR_HRS")
F.Data.Dictionary.AddItem("dictColumns", "FRIDAY_HOURS_EDIT", "FRI_HRS")
F.Data.Dictionary.AddItem("dictColumns", "SATURDAY_HOURS_EDIT", "SAT_HRS")
F.Data.Dictionary.AddItem("dictColumns", "SUN_HRS", "SUNDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "MON_HRS", "MONDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "TUES_HRS", "TUESDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "WED_HRS", "WEDNESDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "THUR_HRS", "THURSDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "FRI_HRS", "FRIDAY_HOURS_EDIT")
F.Data.Dictionary.AddItem("dictColumns", "SAT_HRS", "SATURDAY_HOURS_EDIT")
F.Data.Dictionary.SetDefaultReturn("dictColumns", "")

V.Local.sWriteColumn.Set(V.Dictionary.dictColumns![V.Args.Column.Trim])
F.Data.Dictionary.Close("dictColumns")

'check if decimal or time column
F.Intrinsic.String.IsInString(V.Args.Column, "HOURS_EDIT", True, V.Local.bInString)

F.Intrinsic.Control.BlockEvents
F.Intrinsic.Control.If(V.Local.bInString)
	'time column, update decimal column
	F.Intrinsic.Control.If(V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Args.Column]!FieldValTrim, =, "")
		F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Args.Column, "0:00")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CallSub(ConvertTimeToDecimal, "TIME", V.DataTable.dtTimesheet(V.Args.RowIndex).[V.Args.Column]!FieldValTrim)
	'F.Intrinsic.Math.Round(V.Args.Decimal, 4, V.Local.fFullDecimal)
	'F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Local.sWriteColumn, V.Local.fFullDecimal)
	F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, V.Local.sWriteColumn, V.Args.Decimal)
F.Intrinsic.Control.ElseIf(v.Local.sWriteColumn, <>, "") 'Added a if statement AA.
	'decimal column, update time column
	F.Intrinsic.Control.CallSub(CalculateTimeColumn, "ROW", V.Args.RowIndex, "COLUMN", V.Args.Column, "TARGET_COLUMN", V.Local.sWriteColumn)
F.Intrinsic.Control.EndIf

'check job total column
F.Intrinsic.Math.Add(V.DataTable.dtTimesheet(V.Args.RowIndex).SUN_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).MON_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).TUES_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).WED_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).THUR_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).FRI_HRS!FieldValTrim, V.DataTable.dtTimesheet(V.Args.RowIndex).SAT_HRS!FieldValTrim, V.Local.fFullDecimal)
F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fFullDecimal)

F.Data.DataTable.SetValue("dtTimesheet", V.Args.RowIndex, "JOB_TOTAL_TIME", V.Args.Time)
F.Intrinsic.Control.UnBlockEvents

v.Global.bSaveMsg.Set(true)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.gsgcTimesheet_CellValueChanged.End

Program.Sub.ConvertTimeToDecimal.Start
F.Intrinsic.Control.Try

V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sSplit.Declare(String)
V.Local.fFullDecimal.Declare(Float)
V.Local.sHours.Declare(String)
V.Local.sMinutes.Declare(String)
V.Local.sNegative.Declare(String, "")
V.Local.sTime.Declare(String)

V.Local.sTime.Set(V.Args.Time)
F.Intrinsic.Control.If(V.Local.sTime.Left1, =, "-")
	V.Local.sNegative.Set("-")
	F.Intrinsic.String.Replace(V.Local.sTime, "-", "", V.Local.sTime)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Split(V.Local.sTime, ":", V.Local.sSplit)
V.Local.fHours.Set(V.Local.sSplit(0).Float)
V.Local.fMinutes.Set(V.Local.sSplit(1).Float)

F.Intrinsic.Math.Div(V.Local.fMinutes, 60, V.Local.fMinutes)
F.Intrinsic.String.Format(V.Local.fHours, "0", V.Local.sHours)
F.Intrinsic.Math.Add(V.Local.fHours, V.Local.fMinutes, V.Local.fFullDecimal)

F.Intrinsic.Math.Round(V.Local.fFullDecimal, 4, V.Local.fFullDecimal)
F.Intrinsic.Variable.AddRV("DECIMAL", V.Local.fFullDecimal)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.ConvertTimeToDecimal.End

Program.Sub.CalculateTimeColumn.Start
F.Intrinsic.Control.Try

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.DataTable.dtTimesheet(V.Args.ROW).[V.Args.COLUMN]!FieldValFloat)
F.Data.DataTable.SetValue("dtTimesheet", V.Args.ROW, V.Args.TARGET_COLUMN, V.Args.Time)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.CalculateTimeColumn.End

Program.Sub.ConvertDecimalToTime.Start
F.Intrinsic.Control.Try

V.Local.fHours.Declare(Float)
V.Local.fMinutes.Declare(Float)
V.Local.sMinutes.Declare(String)
V.Local.sHours.Declare(String)
V.Local.sTime.Declare(String)
V.Local.sNegative.Declare(String, "")

F.Intrinsic.Control.If(V.Args.Decimal, <, 0)
	V.Local.sNegative.Set("-")
F.Intrinsic.Control.EndIf

F.Intrinsic.Math.Mult(V.Args.Decimal, 60, V.Local.fMinutes)
F.Intrinsic.Math.IDiv(V.Local.fMinutes, 60, V.Local.fHours)
F.Intrinsic.Math.Mod(V.Local.fMinutes, 60, V.Local.fMinutes)
F.Intrinsic.Math.Abs(V.Local.fMinutes, V.Local.fMinutes)
F.Intrinsic.Math.Abs(V.Local.fHours, V.Local.fHours)
F.Intrinsic.String.Format(V.Local.fHours, "0", V.Local.sHours)
F.Intrinsic.Math.Round(V.Local.fMinutes, 0, V.Local.fMinutes)
F.Intrinsic.Control.If(V.Local.fMinutes, >, 59)
	F.Intrinsic.Math.Add(V.Local.fHours, 1, V.Local.fHours)
	V.Local.fMinutes.Set("0")
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Format(V.Local.fMinutes, "00", V.Local.sMinutes)
F.Intrinsic.String.Build("{2}{0}:{1}", V.Local.sHours, V.Local.sMinutes, V.Local.sNegative, V.Local.sTime)

F.Intrinsic.Control.If(V.Local.sTime, =, "-0:00")
	F.Intrinsic.String.Replace(V.Local.sTime, "-", "", V.Local.sTime)
F.Intrinsic.Control.EndIf

F.Intrinsic.Variable.AddRV("TIME", V.Local.sTime)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.ConvertDecimalToTime.End

Program.Sub.CalculateAllTimeColumns.Start
F.Intrinsic.Control.Try

V.Local.iCounter.Declare(Long)
V.Local.iJ.Declare(Long)
V.Local.sColumns.Declare(String, "SUN_HRS@!@SUNDAY_HOURS_EDIT*!*MON_HRS@!@MONDAY_HOURS_EDIT*!*TUES_HRS@!@TUESDAY_HOURS_EDIT*!*WED_HRS@!@WEDNESDAY_HOURS_EDIT*!*THUR_HRS@!@THURSDAY_HOURS_EDIT*!*FRI_HRS@!@FRIDAY_HOURS_EDIT*!*SAT_HRS@!@SATURDAY_HOURS_EDIT*!*JOB_SUM@!@JOB_TOTAL_TIME")
V.Local.sSplit.Declare(String)

F.Intrinsic.String.Split(V.Local.sColumns, "*!*", V.Local.sColumns)
F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sColumns.UBound, 1)
	F.Intrinsic.String.Split(V.Local.sColumns(V.Local.iCounter), "@!@", V.Local.sSplit)
	F.Intrinsic.Control.For(V.Local.iJ, 0, V.DataTable.dtTimesheet.RowCount--, 1)
		F.Intrinsic.Control.CallSub(CalculateTimeColumn, "ROW", V.Local.iJ, "COLUMN", V.Local.sSplit(0), "TARGET_COLUMN", V.Local.sSplit(1))
	F.Intrinsic.Control.Next(V.Local.iJ)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.CalculateAllTimeColumns.End

Program.Sub.cmdFrmTemp_Click.Start
F.Intrinsic.Control.Try

v.local.sSQL.Declare(string)
v.local.sMap.Declare(string)

F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Global.sUser.Set(v.Screen.FormTimesheet!txtUser.text)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.Global.sUser.Trim,=,"")
	F.Intrinsic.UI.Msgbox("No Employee Selected!","Select Employee")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select JOB, SUFFIX, SEQ,JOB + SUFFIX + SEQ AS JSS,JOB + SUFFIX AS JS,RTRIM(' ') as DESCRIPTION,RTRIM(WC) as WC,  CAST(0 AS DOUBLE) AS MON_HRS,CAST(' ' as LONGVARCHAR) as MON_NOTES, CAST(0 AS DOUBLE) AS TUES_HRS,CAST(' ' as LONGVARCHAR)  as TUES_NOTES, CAST(0 AS DOUBLE) AS WED_HRS,CAST(' ' as LONGVARCHAR)  as WED_NOTES, CAST(0 AS DOUBLE) AS THUR_HRS,CAST(' ' as LONGVARCHAR)  as THUR_NOTES, CAST(0 AS DOUBLE) AS FRI_HRS,CAST(' ' as LONGVARCHAR)  as FRI_NOTES, CAST(0 AS DOUBLE) AS SAT_HRS,CAST(' ' as LONGVARCHAR)  as SAT_NOTES,CAST(0 AS DOUBLE) AS SUN_HRS,CAST(' ' as LONGVARCHAR) as SUN_NOTES,CAST(0 AS BIT) AS UPDATED,CAST(0 AS BIT) AS FLAG_READY,CAST('      ' as VARCHAR) as SUN_NOTES from GCG_6574_TIMSHT_TEMP where UPPER(USER_ID) = '{0}' and JSS not in (Select job + suffix + seq as JSS from GCG_6574_TIMSHT where UPPER(USER_ID) = '{0}' AND BEG_WEEK = '{1}') ORDER BY JOB,SUFFIX, SEQ",V.Global.sUser,v.Global.dDate.PervasiveDate,V.Local.sSql)

F.Data.DataTable.CreateFromSQL("TimeDT","con",V.Local.sSql,true)
F.Intrinsic.Control.If(v.DataTable.TimeDT.RowCount,=,0)
	F.Intrinsic.ui.Msgbox("There are no Jobs that can be added in from the template.")
	F.Data.DataTable.Close("TimeDT")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Data.DataTable.AddColumn("TimeDT","USER_ID","STRING")
F.Data.DataTable.SetValue("TimeDT",-1,"USER_ID",V.Global.sUser)

F.Data.DataTable.AddColumn("TimeDT","BEG_WEEK","STRING")
F.Data.DataTable.SetValue("TimeDT",-1,"BEG_WEEK",V.Global.dDate.PervasiveDate)
v.Local.sMap.set("USER_ID@!@USER_ID*!*JOB@!@JOB*!*SUFFIX@!@SUFFIX*!*SEQ@!@SEQ*!*BEG_WEEK@!@BEG_WEEK*!*WC@!@WC*!*SUN_HRS@!@SUN_HRS*!*MON_HRS@!@MON_HRS*!*TUES_HRS@!@TUES_HRS*!*WED_HRS@!@WED_HRS*!*THUR_HRS@!@THUR_HRS*!*FRI_HRS@!@FRI_HRS*!*SAT_HRS@!@SAT_HRS*!*UPDATED@!@UPDATED*!*FLAG_READY@!@FLAG_READY")
Function.Data.DataTable.SaveToDB("TimeDT","con","GCG_6574_TIMSHT","USER_ID*!*JOB*!*SUFFIX*!*SEQ*!*BEG_WEEK",256,v.Local.sMap)

F.Data.DataTable.Close("TimeDT")

F.Intrinsic.Control.CallSub(GridLoad)
F.Intrinsic.Control.CallSub(GridTitle)
F.Intrinsic.Control.CallSub(ComputeTotals)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdFrmTemp_Click.End

Program.Sub.MessageBox.Start
'they wanted blue text on the message boxes
'so I had to make a seperate form for it

F.Intrinsic.Control.Try

V.Local.bYesAndNo.Declare(Boolean)
V.Local.sTitle.Declare(String)
V.Local.sMessage.Declare(String)

V.Local.bYesAndNo.Set(V.Args.YesAndNo)
V.Local.sTitle.Set(V.Args.Title)
V.Local.sMessage.Set(V.Args.Message)

F.Intrinsic.Control.If(V.Local.bYesAndNo)
	GUI.FormMessageBox.cmdMsgNo.Visible(True)
	GUI.FormMessageBox.cmdMsgNo.Position(4515, 1425)
	GUI.FormMessageBox.cmdMsgNo.Caption("No")
	GUI.FormMessageBox.cmdMsgYes.Visible(True)
	GUI.FormMessageBox.cmdMsgYes.Position(3390, 1425)
	GUI.FormMessageBox.cmdMsgYes.Caption("Yes")
F.Intrinsic.Control.Else
	GUI.FormMessageBox.cmdMsgNo.Visible(False)
	GUI.FormMessageBox.cmdMsgYes.Visible(True)
	GUI.FormMessageBox.cmdMsgYes.Position(4515, 1425)
	GUI.FormMessageBox.cmdMsgYes.Caption("OK")
F.Intrinsic.Control.EndIf

GUI.FormMessageBox..Caption(V.Local.sTitle)
GUI.FormMessageBox.lblMsgBox.Caption(V.Local.sMessage)

GUI.FormTimesheet..Enabled(False)
GUI.FormMessageBox..Show
GUI.FormMessageBox..WaitForDismiss
GUI.FormTimesheet..AlwaysOnTop(True)
GUI.FormTimesheet..AlwaysOnTop(False)
GUI.FormTimesheet..Enabled(True)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.MessageBox.End

Program.Sub.FormMessageBox_UnLoad.Start
F.Intrinsic.Control.Try

V.Global.sMessageBoxReturn.Set("NO")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.FormMessageBox_UnLoad.End

Program.Sub.cmdMsgYes_Click.Start
F.Intrinsic.Control.Try

V.Global.sMessageBoxReturn.Set("YES")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdMsgYes_Click.End

Program.Sub.cmdMsgNo_Click.Start
F.Intrinsic.Control.Try

V.Global.sMessageBoxReturn.Set("NO")
GUI.FormMessageBox..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdMsgNo_Click.End

Program.Sub.SetIcon.Start
F.Intrinsic.Control.Try

V.Local.sForm.Declare(String)
V.Local.bExists.Declare(Boolean)
V.Local.sIcon.Declare(String)
V.Local.iCounter.Declare(Long)

F.Intrinsic.String.Build("{0}\ART\gss2.ico",V.Caller.GlobalDir,v.Local.sIcon)
F.Intrinsic.File.Exists(V.Local.sIcon, V.Local.bExists)
F.Intrinsic.Control.If(V.Local.bExists.Not)
	F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
	F.Intrinsic.File.Exists(V.Local.sIcon, V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists.Not)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.UI.GetFormList(V.Local.sForm)
F.Intrinsic.String.Split(V.Local.sForm, "*!*", V.Local.sForm)

F.Intrinsic.Control.For(V.Local.iCounter, 0, V.Local.sForm.UBound, 1)
	GUI.[V.Local.sForm(V.Local.iCounter)]..Icon(V.Local.sIcon)
F.Intrinsic.Control.Next(V.Local.iCounter)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.SetIcon.End

Program.Sub.ErrorMessage.Start
'basic error message for replacing catch block
'this is really just for when printing the message and ending program
'pass error number, error description, current subroutine
'optional callback sub, this will be called before ending

F.Intrinsic.Control.Try

V.Local.iError.Declare(Long)
V.Local.sErrorDescription.Declare(String)
V.Local.sSubroutine.Declare(String)
V.Local.sError.Declare(String)
V.Local.bExists.Declare(Boolean)
V.Local.sCallback.Declare(String)
V.Static.bError.Declare(Boolean, False)

V.Local.iError.Set(V.Args.ErrorNumber)
V.Local.sErrorDescription.Set(V.Args.ErrorDescription)
V.Local.sSubroutine.Set(V.Args.Subroutine)

'make sure we aren't in an error loop
F.Intrinsic.Control.If(V.Static.bError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndIf
V.Static.bError.Set(True)

F.Intrinsic.String.Build("{6}{1}Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}", V.Caller.ScriptFile, V.Ambient.Newline, V.Local.sSubroutine, V.Local.iError, V.Local.sErrorDescription, V.Ambient.GABVersion, V.Ambient.Now, V.Local.sError)
F.Intrinsic.UI.Msgbox(V.Local.sError)

F.Intrinsic.Variable.ArgExists("Callback", V.Local.bExists)
F.Intrinsic.Control.If(V.Local.bExists)
	V.Local.sCallback.Set(V.Args.Callback.Trim)
	F.Intrinsic.Control.CallSub(V.Local.sCallback)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.End

F.Intrinsic.Control.Catch
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Caller.ScriptFile,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.ErrorMessage.End

Program.Sub.LoadJobTime.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
V.Local.dStartDate.Declare(Date)
V.Local.dEndDate.Declare(Date)
V.Local.sEmployee.Declare(String)
V.Local.sRet.Declare(String)
V.Local.fHours.Declare(Float)
V.Local.sHours.Declare(String)

'get employee
F.Intrinsic.Control.If(v.Global.bAdminMode)
	V.Local.sEmployee.Set(V.Screen.FormTimesheet!txtEmployee.Text.Trim)
F.Intrinsic.Control.Else
	F.Global.Security.GetEmpNoFromUser(V.Global.sUser, V.Local.sEmployee)
	F.Intrinsic.Control.If(V.Local.sEmployee.IsNoReturn)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'get date range
V.Local.dStartDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
F.Intrinsic.Date.DateAdd("D", 6, V.Local.dStartDate, V.Local.dEndDate)

F.Intrinsic.String.Build("select SUM(HOURS_WORKED) TOTAL_HOURS from V_JOB_DETAIL where EMPL = '{0}' and CHARGE_DATE between '{1}' and '{2}' group by EMPL", V.Local.sEmployee, V.Local.dStartDate.PervasiveDate, V.Local.dEndDate.PervasiveDate, V.Local.sSQL)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSQL, V.Local.sRet)
F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.fHours.Set(0)
F.Intrinsic.Control.Else
	V.Local.fHours.Set(V.Local.sRet.Float)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(ConvertDecimalToTime, "DECIMAL", V.Local.fHours)
GUI.FormTimesheet.txtGUIHours.Text(V.Args.Time)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.LoadJobTime.End

Program.Sub.LoadGridJobTime.Start
F.Intrinsic.Control.Try

V.Local.sSQL.Declare(String)
V.Local.dStartDate.Declare(Date)
V.Local.dEndDate.Declare(Date)
V.Local.sEmployee.Declare(String)
V.Local.sRet.Declare(String)
V.Local.fHours.Declare(Float)
V.Local.sHours.Declare(String)
V.Local.iCounter.Declare(Long)
V.Local.sFilter.Declare(String)
V.Local.sColumn.Declare(String)
V.Local.iDifference.Declare(Long)
V.Local.sMainDataTableColumn.Declare(String)

'F.Data.DataTable.AddColumn("dtTimesheet", "SUNDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "MONDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "TUESDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "WEDNESDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "THURSDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "FRIDAY_JOB_DETAIL_HOURS", "Float", 0)
'F.Data.DataTable.AddColumn("dtTimesheet", "SATURDAY_JOB_DETAIL_HOURS", "Float", 0)

''get employee
'F.Intrinsic.Control.If(v.Global.bAdminMode)
'	V.Local.sEmployee.Set(V.Screen.FormTimesheet!txtEmployee.Text.Trim)
'F.Intrinsic.Control.Else
'	F.Global.Security.GetEmpNoFromUser(V.Global.sUser, V.Local.sEmployee)
'	F.Intrinsic.Control.If(V.Local.sEmployee.IsNoReturn)
'		'F.Intrinsic.String.Build("No employee tied to the user '{0}', clock in time will not be pulled in.", V.Global.sUser, V.Local.sMessage)
'		'F.Intrinsic.UI.Msgbox(V.Local.sMessage)
'		F.Intrinsic.Control.ExitSub
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.EndIf

''get date range
'V.Local.dStartDate.Set(V.Screen.FormTimesheet!dtpWeek.Value)
'F.Intrinsic.Date.DateAdd("D", 6, V.Local.dStartDate, V.Local.dEndDate)

'F.Intrinsic.String.Build("select RTRIM(JOB) + RTRIM(SUFFIX) + RTRIM(SEQ) JSS, CHARGE_DATE, SUM(HOURS_WORKED) TOTAL_HOURS from V_JOB_DETAIL where EMPL = '{0}' and CHARGE_DATE between '{1}' and '{2}' group by JSS, CHARGE_DATE", V.Local.sEmployee, V.Local.dStartDate.PervasiveDate, V.Local.dEndDate.PervasiveDate, V.Local.sSQL)
'F.Data.DataTable.CreateFromSQL("dtJobHours", "Con", V.Local.sSQL)

'F.Data.DataView.Create("dtTimesheet", "dvLoadHours", 22)
'F.Intrinsic.Control.For(V.Local.iCounter, 0, V.DataTable.dtJobHours.RowCount--, 1)
'	
'	'get the column based off the date
'	F.Intrinsic.Date.DateDiff("D", V.DataTable.dtJobHours(V.Local.iCounter).CHARGE_DATE!FieldVal, V.Local.dStartDate, V.Local.iDifference)
'	F.Intrinsic.Control.SelectCase(V.Local.iDifference)
'		F.Intrinsic.Control.Case(0)
'			V.Local.sColumn.Set("SUNDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("SUN_HRS")
'		F.Intrinsic.Control.Case(1)
'			V.Local.sColumn.Set("MONDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("MON_HRS")
'		F.Intrinsic.Control.Case(2)
'			V.Local.sColumn.Set("TUESDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("TUES_HRS")
'		F.Intrinsic.Control.Case(3)
'			V.Local.sColumn.Set("WEDNESDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("WED_HRS")
'		F.Intrinsic.Control.Case(4)
'			V.Local.sColumn.Set("THURSDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("THURS_HRS")
'		F.Intrinsic.Control.Case(5)
'			V.Local.sColumn.Set("FRIDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("FRI_HRS")
'		F.Intrinsic.Control.Case(6)
'			V.Local.sColumn.Set("SATURDAY_JOB_DETAIL_HOURS")
'			V.Local.sMainDataTableColumn.Set("SAT_HRS")
'	F.Intrinsic.Control.EndSelect
'	
'	'see if the job is already in the timesheet
'	F.Intrinsic.String.Build("JSS = '{0}'", V.DataTable.dtJobHours(V.Local.iCounter).JSS!FieldValTrim, V.Local.sFilter)
'	F.Data.DataView.SetFilter("dtTimesheet", "dvLoadHours", V.Local.sFilter)
'	F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvLoadHours.RowCount, >, 0)
'		F.Intrinsic.Control.If(V.DataView.dtTimesheet!dvLoadHours(0).UPDATED!FieldVal, =, True)
'			F.Intrinsic.Math.Sub(V.DataTable.dtJobHours(V.Local.iCounter).TOTAL_HOURS!FieldValFloat, V.DataView.dtTimesheet!dvLoadHours(0).[V.Local.sMainDataTableColumn]!FieldValFloat, V.Local.fHours)
'		F.Intrinsic.Control.Else
'			V.Local.fHours.Set(V.DataTable.dtJobHours(V.Local.iCounter).TOTAL_HOURS!FieldValFloat)
'		F.Intrinsic.Control.EndIf
'		
'		F.Data.DataView.SetValue("dtTimesheet", "dvLoadHours", -1, V.Local.sMainDataTableColumn, V.Local.fHours)
'	F.Intrinsic.Control.Else
'		'do we want to add it?
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.Next(V.Local.iCounter)
'F.Data.DataView.Close("dtTimesheet", "dvLoadHours")
'F.Data.DataTable.Close("dtJobHours")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.LoadGridJobTime.End

Program.Sub.txtUser_LostFocus.Start
F.Intrinsic.Control.Try

V.Local.sUser.Declare(String)
V.Local.sEmployee.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.Control.If(V.Screen.FormTimesheet!txtUser.Text.Trim, !=, "")
	V.Local.sUser.Set(V.Screen.FormTimesheet!txtUser.Text.Trim)
	V.Local.sUser.Set(V.Local.sUser.UCase)

	F.Intrinsic.String.Build("select RTRIM(GS_USER) from USER_INFORMATION where GS_USER = '{0}'", V.Local.sUser, V.Local.sSQL)
	F.ODBC.Connection!Comm.OpenCommonConnection
	F.ODBC.Connection!Comm.ExecuteAndReturn(V.Local.sSQL, V.Local.sRet)
	F.ODBC.Connection!Comm.Close
	
	F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
		F.Intrinsic.UI.Msgbox("Invalid user entered.")
		GUI.FormTimesheet.txtUser.Text("")
		GUI.FormTimesheet.txtEmployee.Text("")
	F.Intrinsic.Control.Else
		F.Global.Security.GetEmpNoFromUser(V.Local.sUser, V.Local.sEmployee)
		F.Intrinsic.Control.If(V.Local.sEmployee.IsNotNoReturn)
			GUI.FormTimesheet.txtEmployee.Text(V.Local.sEmployee)
		F.Intrinsic.Control.Else
			GUI.FormTimesheet.txtEmployee.Text("")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.txtUser_LostFocus.End

Program.Sub.cmdAddNotes_Click.Start
F.Intrinsic.Control.Try
	gui.F_newNotes..Visible(True)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdAddNotes_Click.End

Program.Sub.F_newNotes_UnLoad.Start
F.Intrinsic.Control.Try
	gui.F_newNotes..Visible(False)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.F_newNotes_UnLoad.End

Program.Sub.cmdNotesOk_Click.Start
F.Intrinsic.Control.Try
	gui.F_newNotes..Visible(False)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.cmdNotesOk_Click.End

Program.Sub.cmd_newOKLine_Click.Start
v.Local.sNotes.Declare

v.Local.sJob.Declare
v.Local.sSuffix.Declare
v.Local.sSeq.Declare
v.Local.sSQL.Declare
v.Local.sUserName.Declare
v.Local.dDTP.Declare
v.Local.sUser.Declare
f.Intrinsic.Control.Try
	v.Local.sNotes.Set(v.Screen.F_New_Line!txt1.Text)
	'Check if Checked
	f.Intrinsic.Control.If(v.Screen.F_New_Line!chk1.Value, =, 1)
		'Get Row Values
		gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "JOB", v.Global.iRowId, v.Local.sJob)
		gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "SUFFIX", v.Global.iRowId, v.Local.sSuffix)
		gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "SEQ", v.Global.iRowId, v.Local.sSeq)
		v.Local.dDTP.Set(v.Screen.F_New_Line!dtp1.Value)
		'get User Name
		'f.Intrinsic.Control.If(v.Global.bAdminMode)
			v.Local.sUser.Set(v.Screen.FormTimesheet!txtUser.Text)
		'f.Intrinsic.Control.Else
		'	v.Local.sUser.Set(v.Caller.User)
		'f.Intrinsic.Control.EndIf
		'f.ODBC.Connection!con.OpenCompanyConnection
			f.Intrinsic.String.Build("select top 1 Name from V_EMPLOYEE_MSTR where PR_USER_ID = '{0}'", v.Local.sUser, v.Local.sSQL)
			f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sUserName)
			f.Intrinsic.String.Left(v.Local.sUserName, 15, v.Local.sUserName)
			'Delete
			f.Intrinsic.String.Build("Delete From GCG_6574_DATE_NOTE Where Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and user_ID = '{3}' and Date_Seq = '{4}'", v.Local.sJob, v.Local.sSuffix, v.Local.sSeq, v.Local.sUser, v.Local.dDTP.PervasiveDate, v.Local.sSQL)
			f.ODBC.Connection!con.Execute(v.Local.sSQL)
			'Insert
			f.Intrinsic.String.Build("Insert into  GCG_6574_DATE_NOTE (Job, Suffix, Seq, USER_ID, USER_NAME, Date_Seq, Job_Notes) Values ('{0}', '{1}', '{2}', '{3}', '{4}', '{5}', '{6}')", v.Local.sJob, v.Local.sSuffix, v.Local.sSeq, v.Local.sUser, v.Local.sUserName, v.Local.dDTP.PervasiveDate, v.Local.sNotes.PSQLFriendly, v.Local.sSQL)
			f.ODBC.Connection!con.Execute(v.Local.sSQL)
		'f.ODBC.Connection!con.Close
	f.Intrinsic.Control.Else
		gui.FormTimesheet.gsgcTimesheet.SetCellValueByColumnName("gvTimesheet", "JOB_NOTES", v.Global.iRowId, v.Local.sNotes)
	f.Intrinsic.Control.EndIf
	'End
	'gui.F_New_Line.txt1.Text("")
	'gui.F_New_Line..Visible(False)	
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.cmd_newOKLine_Click.End

Program.Sub.F_New_Line_UnLoad.Start
F.Intrinsic.Control.Try
	gui.F_New_Line.txt1.Text("")
	gui.F_New_Line..Visible(False)
F.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
F.Intrinsic.Control.EndTry
Program.Sub.F_New_Line_UnLoad.End

Program.Sub.chk1_Change.Start
v.Local.sNotes.Declare

v.Local.sJob.Declare
v.Local.sSuffix.Declare
v.Local.sSeq.Declare
v.Local.sSQL.Declare
v.Local.sUserName.Declare
v.Local.dDTP.Declare
v.Local.sUser.Declare
f.Intrinsic.Control.Try
	'Check if Checked
	f.Intrinsic.Control.If(v.Screen.F_New_Line!chk1.Value, =, 1)
		'Get Row Values
		gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "JOB", v.Global.iRowId, v.Local.sJob)
		gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "SUFFIX", v.Global.iRowId, v.Local.sSuffix)
		gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "SEQ", v.Global.iRowId, v.Local.sSeq)
		v.Local.dDTP.Set(v.Screen.F_New_Line!dtp1.Value)
		
		'get User Name
'		f.Intrinsic.Control.If(v.Global.bAdminMode)
			v.Local.sUser.Set(v.Screen.FormTimesheet!txtUser.Text)
'		f.Intrinsic.Control.Else
'			v.Local.sUser.Set(v.Caller.User)
'		f.Intrinsic.Control.EndIf
		
		'f.ODBC.Connection!con.OpenCompanyConnection
			'Get notes
			f.Intrinsic.String.Build("Select top 1 Job_Notes From GCG_6574_DATE_NOTE Where Job = '{0}' and Suffix = '{1}' and Seq = '{2}' and user_ID = '{3}' and Date_Seq = '{4}'", v.Local.sJob, v.Local.sSuffix, v.Local.sSeq, v.Local.sUser, v.Local.dDTP.PervasiveDate, v.Local.sSQL)
			f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL, v.Local.sNotes)
		'f.ODBC.Connection!con.Close
	f.Intrinsic.Control.Else
		'Get Notes
		gui.FormTimesheet.gsgcTimesheet.GetCellValueByColumnName("gvTimesheet", "JOB_NOTES", v.Global.iRowId, v.Local.sNotes)
	f.Intrinsic.Control.EndIf
	gui.F_New_Line.txt1.Text(v.Local.sNotes)
f.Intrinsic.Control.Catch
	F.Intrinsic.Control.CallSub(ErrorMessage, "ErrorNumber", V.Ambient.ErrorNumber, "ErrorDescription", V.Ambient.ErrorDescription, "Subroutine", V.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.chk1_Change.End

Program.Sub.ErrorMsg.Start
v.Local.sError.Declare

'Generic Error message.
f.Intrinsic.String.Build("Project GCG_6574_TimeSheet.g2u {0}{0}Subroutine: {1}{0}Error: {2} with Description: {3}", v.Ambient.NewLine, v.Args.CurrentSub, v.Ambient.ErrorNumber, v.Ambient.ErrorDescription, v.Local.sError)
f.Intrinsic.UI.Msgbox(v.Local.sError)
Program.Sub.ErrorMsg.End

Program.Sub.dtp1_Change.Start
f.Intrinsic.Control.Try
	f.Intrinsic.Control.CallSub(chk1_Change)
f.Intrinsic.Control.Catch
	f.Intrinsic.Control.CallSub(ErrorMsg, CurrentSub, v.Ambient.CurrentSubroutine)
f.Intrinsic.Control.EndTry
Program.Sub.dtp1_Change.End

Program.Sub.Comments.Start
${$5$}$2.0.0.0$}$2
${$6$}$aanazco$}$20220920141636159$}$7aQAV3Tor/tR9bkuakHbuzQlHVuXCGOzGmdH6wkpI9Wu0t8xEOCzJ9GDXAD/nrrKFY3Z+n3hHzE=
Program.Sub.Comments.End